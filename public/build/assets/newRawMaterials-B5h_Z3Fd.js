import{r as l,u as v,b as w,j as e}from"./index-DaQ8IcWH.js";import{a as b,p as P}from"./api-CIBCEetx.js";import{u as N}from"./DefaultLayout-CNbVm5ae.js";import{C as F,a as E}from"./CCardBody-BgdPVtOX.js";import{C as M}from"./CCardHeader-BnYSwQm7.js";import{a as R,b as i}from"./index.esm-W-SaLQ2H.js";import{C as m}from"./CFormLabel-B6T8hfcB.js";import{C as p}from"./CFormInput-CplwN3WM.js";import{C as S}from"./CFormSelect-fqNFrf6e.js";import{C as u}from"./CButton-RPa9QO-M.js";import"./RawMaterial-BtjEDAbB.js";import"./cil-mobile-kffaxYCk.js";import"./CFormControlWrapper-CkuovpMX.js";const K=()=>{const[r,h]=l.useState({name:"",local_name:"",project_id:"",current_stock:"",price:"",capacity:"",total:0,unit:"",contact:"",payment_by:"",payment_type:""}),d=v(),{showToast:c}=w(),[j,f]=l.useState([]);N("global"),l.useEffect(()=>{(async()=>{try{const a=await b("/api/myProjects");f(a||[])}catch(a){console.error("Error fetching projects",a)}})()},[]);const n=t=>{const{name:a,value:s}=t.target,o={...r,[a]:s};if(a==="current_stock"||a==="price"){const y=parseFloat(a==="current_stock"?s:o.current_stock)||0,_=parseFloat(a==="price"?s:o.price)||0;o.total=y*_}a==="contact"&&!/^\d{0,10}$/.test(s)||h(o)},C=()=>r.name.trim()?r.local_name.trim()?r.project_id.trim()?null:"Please select a Project.":"Please enter local Material Name.":"Please enter Material Name.",x=async t=>{t.preventDefault();const a=C();if(a){c("danger",a);return}try{await P("/api/store",{...r}),c("success","Raw material saved successfully!"),d("/showRawMaterials")}catch(s){console.error(s),c("danger","Error adding raw material.")}},g=()=>d("/showRawMaterials");return e.jsxs(F,{className:"mb-4",children:[e.jsx(M,{children:e.jsx("strong",{children:"New Raw Material"})}),e.jsx(E,{children:e.jsxs("form",{onSubmit:x,children:[e.jsxs(R,{className:"mb-3",children:[e.jsxs(i,{md:4,children:[e.jsx(m,{children:"Name *"}),e.jsx(p,{name:"name",value:r.name,onChange:n,placeholder:"Enter material name"})]}),e.jsxs(i,{md:4,children:[e.jsx(m,{children:"Local Name"}),e.jsx(p,{name:"local_name",value:r.local_name,onChange:n,placeholder:"Enter local name"})]}),e.jsxs(i,{md:4,children:[e.jsx(m,{children:"Project *"}),e.jsxs(S,{name:"project_id",value:r.project_id,onChange:n,children:[e.jsx("option",{value:"",children:"-- Select Project --"}),j.map(t=>e.jsx("option",{value:t.id,children:t.project_name},t.id))]})]})]}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(u,{type:"submit",color:"primary",children:"Save"}),e.jsx(u,{type:"button",color:"secondary",onClick:g,children:"Close"})]})]})})]})};export{K as default};
