import{d as F,b as L,r as d,j as e}from"./index-Cs-5ghpe.js";import{a as S,b as E,c as g}from"./api-CIBCEetx.js";import{u as R}from"./DefaultLayout-05E0ZdWa.js";import{a as k,b as I}from"./index.esm-DS-fhHF9.js";import{C as A,a as B}from"./CCardBody-CWVv-Bam.js";import{C as w}from"./CCardHeader-B5GdMtlk.js";import{C as D}from"./CForm-BcOVBk6n.js";import{C as l}from"./CFormLabel-DHukGEEc.js";import{C as t}from"./CFormInput-BnDllJdd.js";import{C as Q}from"./CFormSelect-DaxkqWsS.js";import{C as P}from"./CButton-n5jldtHI.js";import"./RawMaterial-BtjEDAbB.js";import"./cil-mobile-CqmbNfnm.js";import"./CFormControlWrapper-fc1Ss_Cu.js";function Z(){const{companyId:h}=F(),{showToast:c}=L(),{t:o}=R("global"),[n,u]=d.useState({companyName:"",land_mark:"",Tal:"",Dist:"",Pincode:"",phone_no:"",email_id:"",bank_name:"",account_no:"",IFSC:"",gst_number:"",pan_number:"",logo:"",sign:"",paymentQRCode:"",appMode:"basic"}),[p,M]=d.useState({phone_no:"",email_id:""}),x=d.useRef(null),f=d.useRef(null),j=d.useRef(null),[C,_]=d.useState(!1),v=[{label:"Basic",value:"basic"},{label:"Advance",value:"advance"}],b=async()=>{try{const a=await S(`/api/company/${h}`);u({companyName:a.company_name||"",land_mark:a.land_mark||"",Tal:a.Tal||"",Dist:a.Dist||"",Pincode:"-1",phone_no:a.phone_no||"",email_id:a.email_id||"",bank_name:a.bank_name||"",account_no:a.account_no||"",IFSC:a.IFSC_code||"",gst_number:a.gst_number||"",pan_number:a.pan_number||"",logo:a.logo||"",sign:a.sign||"",paymentQRCode:a.paymentQRCode||"",appMode:a.appMode||"basic"})}catch(a){console.error("Error fetching company details:",a),c("danger","Failed to fetch company details.")}};d.useEffect(()=>{h&&b()},[h]);const i=a=>{const{name:s,value:m,files:r}=a.target;r&&r.length>0?u({...n,[s]:r[0]}):u({...n,[s]:m})},y=async()=>{try{let a={...n};if(n.logo instanceof File){const s=new FormData;s.append("file",n.logo),s.append("dest","invoice");const r=(await g("/api/fileUpload",s)).fileName;r&&(a.logo=r)}if(n.sign instanceof File){const s=new FormData;s.append("file",n.sign),s.append("dest","invoice");const r=(await g("/api/fileUpload",s)).fileName;r&&(a.sign=r)}if(n.paymentQRCode instanceof File){const s=new FormData;s.append("file",n.paymentQRCode),s.append("dest","invoice");const r=(await g("/api/fileUpload",s)).fileName;r&&(a.paymentQRCode=r)}return a}catch(a){return c("danger","Error uploading files: "+a),console.error("Error uploading files:",a),null}},N=async a=>{const s=a.currentTarget;if(a.preventDefault(),a.stopPropagation(),_(!0),s.checkValidity()!==!0){c("danger","Kindly provide data of all required fields");return}try{const m=await y();if(!m){c("danger","Failed to prepare form data");return}const r=await E(`/api/company/${h}`,m);c("success","Company details updated successfully.")}catch(m){console.error("Error updating company:",m),c("danger","Error occurred: "+(m.message||"Unknown error"))}};return e.jsx(k,{children:e.jsx(I,{xs:12,children:e.jsxs(A,{className:"mb-3",children:[e.jsx(w,{children:e.jsx("strong",{children:o("LABELS.edit_shop")})}),e.jsx(B,{children:e.jsxs(D,{noValidate:!0,validated:C,onSubmit:N,encType:"multipart/form-data",children:[e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"land_mark",children:o("LABELS.company_name")}),e.jsx(t,{type:"text",name:"companyName",id:"companyName",maxLength:"32",value:n.companyName,onChange:i,feedbackInvalid:"Please provide valid data.",required:!0})]})}),e.jsx("div",{className:"col-sm-8",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"land_mark",children:o("LABELS.address")}),e.jsx(t,{type:"text",name:"land_mark",id:"land_mark",maxLength:"32",value:n.land_mark,onChange:i,feedbackInvalid:"Please provide shop address.",required:!0})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"phone_no",children:o("LABELS.mobile_number")}),e.jsx(t,{type:"text",name:"phone_no",id:"phone_no",value:n.phone_no,onChange:i,invalid:!!p.phone_no,feedbackInvalid:p.phone_no!=""?p.phone_no:"Please provide valid 10 digit mobile.",pattern:"\\d{10}",required:!0,minLength:10,maxLength:10})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"email_id",children:o("LABELS.email")}),e.jsx(t,{type:"email",name:"email_id",id:"email_id",invalid:!!p.email_id,value:n.email_id,onChange:i,feedbackInvalid:p.email_id!=""?p.email_id:"Please provide email address.",required:!0})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"appMode",children:o("LABELS.app_mode")}),e.jsx(Q,{"aria-label":"Select Application Mode",value:n.appMode,id:"appMode",name:"appMode",options:v,onChange:i,required:!0,feedbackInvalid:"Select an application mode."})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"bank_name",children:o("LABELS.bank_name")}),e.jsx(t,{type:"text",name:"bank_name",id:"bank_name",value:n.bank_name,onChange:i})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"account_no",children:o("LABELS.account_number")}),e.jsx(t,{type:"number",name:"account_no",id:"account_no",value:n.account_no,onChange:i})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"IFSC",children:o("LABELS.IFSC")}),e.jsx(t,{type:"text",name:"IFSC",id:"IFSC",value:n.IFSC,onChange:i})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"GST Number",children:o("LABELS.gst_number")}),e.jsx(t,{type:"text",name:"gst_number",id:"gst_number",value:n.gst_number,onChange:i})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"Pan Number",children:o("LABELS.pan_number")}),e.jsx(t,{type:"text",name:"pan_number",id:"pan_number",value:n.pan_number,onChange:i})]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"logo",children:o("LABELS.logo")}),e.jsx(t,{type:"file",name:"logo",id:"logo",accept:"image/png/jpeg",onChange:i,ref:x}),typeof n.logo=="string"&&n.logo&&e.jsxs("small",{className:"text-muted",children:["Current file: ",n.logo]})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"sign",children:o("LABELS.sign")}),e.jsx(t,{type:"file",name:"sign",id:"sign",accept:"image/png/jpeg",onChange:i,ref:f}),typeof n.sign=="string"&&n.sign&&e.jsxs("small",{className:"text-muted",children:["Current file: ",n.sign]})]})}),e.jsx("div",{className:"col-sm-4",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(l,{htmlFor:"paymentQRCode",children:o("LABELS.qr_img")}),e.jsx(t,{type:"file",name:"paymentQRCode",id:"paymentQRCode",accept:"image/png/jpeg",onChange:i,ref:j}),typeof n.paymentQRCode=="string"&&n.paymentQRCode&&e.jsxs("small",{className:"text-muted",children:["Current file: ",n.paymentQRCode]})]})})]}),e.jsx(P,{type:"submit",color:"primary",children:o("LABELS.update")})]})})]})})})}export{Z as default};
