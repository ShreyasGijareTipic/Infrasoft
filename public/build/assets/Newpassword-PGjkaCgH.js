import{b as I,r as a,u as N,j as s}from"./index-C2yVeD7S.js";import{a as k,p as R}from"./api-CIBCEetx.js";import{a as T,b as q,c as n}from"./index.esm-BfesGHR4.js";import{u as F}from"./DefaultLayout-BQzMumzV.js";import{C as V,a as D}from"./CCardBody-D-jAy6vr.js";import{C as G}from"./CCardHeader-6bNqU1xa.js";import{C as M}from"./CForm-9WpppnGX.js";import{C as c}from"./CInputGroup-Dl8FeEzY.js";import{C as i}from"./CInputGroupText-BfFQ-DqL.js";import{a as l}from"./cil-mobile-YEmBCbC2.js";import{C as p}from"./CFormInput-CXoXZ5N_.js";import{b as C}from"./CFormControlWrapper-D7XNeBGJ.js";import{C as U}from"./CButton-pXUvGqWL.js";import"./RawMaterial-BtjEDAbB.js";import"./CFormLabel-eLpXnSYX.js";const ds=()=>{const{t:r,i18n:H}=F("global"),{showToast:o}=I(),[x,f]=a.useState(""),u=a.useRef(),[m,L]=a.useState(""),[j,_]=a.useState(""),[w,E]=a.useState(!1),[z,g]=a.useState(!0),[S,P]=a.useState(!1),v=N();a.useEffect(()=>{B()},[]);const B=async()=>{try{const e=await k("/api/user");f(e.email)}catch(e){o("danger",r("LABELS.error_occurred")+" "+e)}},b=e=>{L(e.target.value),h(e.target.value,j)},y=e=>{_(e.target.value),h(m,e.target.value)},h=(e,t)=>{const d=e===t;E(!d),g(d)},A=async e=>{if(e.preventDefault(),P(!0),e.currentTarget.checkValidity()===!1||w){e.stopPropagation();return}try{const t={email:x,password:u.current.value,new_password:m};(await R("/api/changePassword",t)).status===1&&(o("success",r("LABELS.password_updated_successfully")),v("/login"))}catch(t){o("danger",r("LABELS.error_occurred")+" "+t)}};return s.jsx(T,{children:s.jsx(q,{xs:12,children:s.jsxs(V,{className:"mb-3",children:[s.jsx(G,{children:s.jsx("strong",{children:r("LABELS.change_password")})}),s.jsx(D,{children:s.jsxs(M,{noValidate:!0,validated:S,onSubmit:A,children:[s.jsx("p",{className:"text-body-secondary",children:r("LABELS.current_password_required")}),s.jsxs(c,{className:"mb-4",children:[s.jsx(i,{children:s.jsx(n,{icon:l})}),s.jsx(p,{ref:u,id:"oldPassword",type:"password",placeholder:r("LABELS.enter_current_password"),autoComplete:"current-password",feedbackInvalid:r("LABELS.please_provide_current_password"),required:!0})]}),s.jsxs(c,{className:"mb-4",children:[s.jsx(i,{children:s.jsx(n,{icon:l})}),s.jsx(p,{onChange:b,id:"newPassword",type:"password",placeholder:r("LABELS.enter_new_password"),autoComplete:"new-password",feedbackInvalid:r("LABELS.please_provide_new_password"),required:!0})]}),s.jsxs(c,{className:"mb-4",children:[s.jsx(i,{children:s.jsx(n,{icon:l})}),s.jsx(p,{onChange:y,id:"reEnterPassword",type:"password",invalid:w,placeholder:r("LABELS.reenter_new_password"),autoComplete:"new-password",required:!0}),s.jsx(C,{invalid:!0,children:r("LABELS.passwords_do_not_match")}),s.jsx(C,{valid:!0,children:r("LABELS.passwords_match")})]}),s.jsx(U,{type:"submit",color:"primary",children:r("LABELS.update_password")})]})})]})})})};export{ds as default};
