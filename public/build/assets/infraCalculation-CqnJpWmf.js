import{r as p,_ as D,R as E,g as M,f as k,P as g,j as e}from"./index-95D3pMM8.js";import{p as H,a as C}from"./api-CIBCEetx.js";import{C as B,a as O}from"./CCardBody-dOzHbfOa.js";import{C as A}from"./CCardHeader-Cq-j3fyp.js";import{C as L}from"./CForm-DyhjnECG.js";import{a as u,b as n}from"./index.esm-DxutiY6j.js";import{C as i}from"./CFormInput-C_VETgxc.js";import{C as I}from"./CButton-B_ZYbnJ4.js";import{C as W,a as z,b as f,c as s,d as Q,e as t}from"./CTable-E2GxfeJ9.js";import"./CFormControlWrapper-DhbFIWP9.js";import"./CFormLabel-C_2Vxs-X.js";var v=p.forwardRef(function(l,_){var j=l.children,m=l.as,y=m===void 0?"h5":m,x=l.className,o=D(l,["children","as","className"]);return E.createElement(y,M({className:k("card-title",x)},o,{ref:_}),j)});v.propTypes={as:g.elementType,children:g.node,className:g.string};v.displayName="CCardTitle";const ae=()=>{const[l,_]=p.useState({date:"",site:"",operator_helper:"",machine_start:"",machine_end:"",actual_hour_machine:"",rpm_start:"",rpm_end:"",actual_hours_rpm:"",drilling_point:"",pilling_point:"",rate:"",total_bill:"",dth_survey_point:"",survey_rate:"",survey_total_bill:"",surveyor_local_work:"",surveyor_payment:"",diesel:""}),[j,m]=p.useState([]),[y,x]=p.useState({name:"",id:null}),o=a=>{const{name:r,value:F}=a.target;let d={...l,[r]:F};if(r==="machine_start"||r==="machine_end"){const c=parseFloat(d.machine_start)||0,h=parseFloat(d.machine_end)||0;d.actual_hour_machine=h>c?(h-c).toFixed(2):0}if(r==="rpm_start"||r==="rpm_end"){const c=parseFloat(d.rpm_start)||0,h=parseFloat(d.rpm_end)||0;d.actual_hours_rpm=h>c?(h-c).toFixed(2):0}if(r==="drilling_point"||r==="pilling_point"||r==="rate"){const c=parseFloat(d.drilling_point)||0,h=parseFloat(d.pilling_point)||0,T=parseFloat(d.rate)||0;d.total_bill=(c+h)*T}if(r==="dth_survey_point"||r==="survey_rate"){const c=parseFloat(d.dth_survey_point)||0,h=parseFloat(d.survey_rate)||0;d.survey_total_bill=c*h}_(d)},S=async a=>{if(a.length>0)try{const r=await C(`/api/searchCustomer?searchQuery=${a}`);m(r||[])}catch(r){console.error("Error fetching customers:",r),alert("Error fetching customers")}else m([])},N=a=>{const r=a.target.value;x({name:r,id:null}),S(r)},R=a=>{x({name:a.name,id:a.id}),_(r=>({...r,site:a.id})),m([])},P=async a=>{a.preventDefault();try{await H("/api/drilling",l),alert("Data Saved Successfully!"),_({date:"",site:"",operator_helper:"",machine_start:"",machine_end:"",actual_hour_machine:"",rpm_start:"",rpm_end:"",actual_hours_rpm:"",drilling_point:"",pilling_point:"",rate:"",total_bill:"",dth_survey_point:"",survey_rate:"",survey_total_bill:"",surveyor_local_work:"",surveyor_payment:"",diesel:""}),x({name:"",id:null}),m([])}catch(r){console.error(r),alert("Error saving data")}},[b,w]=p.useState([]);return console.log(b),p.useEffect(()=>{(async()=>{try{const r=await C("/api/drilling");w(r.data)}catch(r){console.error("Error fetching drilling records:",r)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(B,{className:"mb-4 shadow-sm",children:[e.jsx(A,{className:"bg-primary text-white",children:e.jsx(v,{children:"Dealiy Work Log"})}),e.jsx(O,{className:"p-4",children:e.jsxs(L,{onSubmit:P,className:"p-3",children:[e.jsxs(u,{className:"mb-3",children:[e.jsxs(n,{md:3,style:{position:"relative"},children:[e.jsx(i,{type:"text",name:"customerName",label:"Project Name",value:y.name,onChange:N,autoComplete:"off",placeholder:"Enter Project Name"}),j.length>0&&e.jsx("ul",{className:"suggestions-list",style:{position:"absolute",zIndex:1e3,background:"white",border:"1px solid #ccc",listStyle:"none",padding:0,maxHeight:"200px",overflowY:"auto",width:"100%"},children:j.map(a=>e.jsxs("li",{onClick:()=>R(a),style:{padding:"8px",cursor:"pointer",borderBottom:"1px solid #eee"},onMouseEnter:r=>r.target.style.background="#f5f5f5",onMouseLeave:r=>r.target.style.background="white",children:[a.name," (",a.mobile,")"]},a.id))})]}),e.jsx(n,{md:3,children:e.jsx(i,{type:"date",name:"date",label:"Date",value:l.date||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"operator_helper",label:"Operator/Helper",value:l.operator_helper||"",onChange:o})})]}),e.jsxs(u,{className:"mb-3",children:[e.jsx(n,{md:3,children:e.jsx(i,{name:"machine_start",label:"Machine Start Reading",value:l.machine_start||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"machine_end",label:"Machine End Reading",value:l.machine_end||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"actual_hour_machine",label:"Actual Hour in Machine",value:l.actual_hour_machine||"",readOnly:!0})})]}),e.jsxs(u,{className:"mb-3",children:[e.jsx(n,{md:3,children:e.jsx(i,{name:"rpm_start",label:"Compressor RPM Start",value:l.rpm_start||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"rpm_end",label:"Compressor RPM End",value:l.rpm_end||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"actual_hours_rpm",label:"Actual Hours RPM",value:l.actual_hours_rpm||"",readOnly:!0})})]}),e.jsxs(u,{className:"mb-3",children:[e.jsx(n,{md:3,children:e.jsx(i,{name:"drilling_point",label:"Drilling Point",value:l.drilling_point||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"pilling_point",label:"Pilling/E/C Point",value:l.pilling_point||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"rate",label:"Rate",value:l.rate||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"total_bill",label:"Total Bill",value:l.total_bill||"",readOnly:!0})})]}),e.jsxs(u,{className:"mb-3",children:[e.jsx(n,{md:3,children:e.jsx(i,{name:"dth_survey_point",label:"DTH Survey Point",value:l.dth_survey_point||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"survey_rate",label:"Survey Rate",value:l.survey_rate||"",onChange:o})}),e.jsx(n,{md:3,children:e.jsx(i,{name:"survey_total_bill",label:"Survey Total Bill",value:l.survey_total_bill||"",readOnly:!0})})]}),e.jsx(u,{className:"mb-3",children:e.jsx(n,{md:3,children:e.jsx(i,{name:"surveyor_local_work",label:"Surveyor Local Work",value:l.surveyor_local_work||"",onChange:o})})}),e.jsx(I,{type:"submit",color:"primary",children:"Save"})]})})]}),e.jsx("div",{className:"table-responsive",children:e.jsxs(W,{bordered:!0,hover:!0,children:[e.jsx(z,{color:"dark",children:e.jsxs(f,{children:[e.jsx(s,{children:"ID"}),e.jsx(s,{children:"Date"}),e.jsx(s,{children:"Site"}),e.jsx(s,{children:"Operator Helper"}),e.jsx(s,{children:"Machine Start"}),e.jsx(s,{children:"Machine End"}),e.jsx(s,{children:"Actual Hour (Machine)"}),e.jsx(s,{children:"RPM Start"}),e.jsx(s,{children:"RPM End"}),e.jsx(s,{children:"Actual Hours (RPM)"}),e.jsx(s,{children:"Drilling Point"}),e.jsx(s,{children:"Pilling Point"}),e.jsx(s,{children:"Rate"}),e.jsx(s,{children:"Total Bill"}),e.jsx(s,{children:"DTH Survey Point"}),e.jsx(s,{children:"Survey Rate"}),e.jsx(s,{children:"Survey Total Bill"}),e.jsx(s,{children:"Surveyor Local Work"}),e.jsx(s,{children:"Surveyor Payment"}),e.jsx(s,{children:"Diesel"})]})}),e.jsx(Q,{children:b.map(a=>e.jsxs(f,{children:[e.jsx(t,{children:a.id}),e.jsx(t,{children:new Date(a.date).toLocaleDateString()}),e.jsx(t,{children:a.site}),e.jsx(t,{children:a.operator_helper}),e.jsx(t,{children:a.machine_start}),e.jsx(t,{children:a.machine_end}),e.jsx(t,{children:a.actual_hour_machine}),e.jsx(t,{children:a.rpm_start}),e.jsx(t,{children:a.rpm_end}),e.jsx(t,{children:a.actual_hours_rpm}),e.jsx(t,{children:a.drilling_point??"-"}),e.jsx(t,{children:a.pilling_point??"-"}),e.jsx(t,{children:a.rate}),e.jsx(t,{children:a.total_bill}),e.jsx(t,{children:a.dth_survey_point}),e.jsx(t,{children:a.survey_rate}),e.jsx(t,{children:a.survey_total_bill}),e.jsx(t,{children:a.surveyor_local_work}),e.jsx(t,{children:a.surveyor_payment}),e.jsx(t,{children:a.diesel})]},a.id))})]})})]})};export{ae as default};
