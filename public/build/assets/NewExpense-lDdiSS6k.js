import{r as x,u as Pe,b as qe,k as ae,j as e}from"./index-DaQ8IcWH.js";import{a as ie,c as le}from"./api-CIBCEetx.js";import{S as Re}from"./react-select.esm-BDjnqGUU.js";import{r as Ie,p as De}from"./Feilds-BHjWXeSc.js";import{a as re,b as oe,c as M}from"./index.esm-W-SaLQ2H.js";import{P as $e}from"./ProjectSelectionModal-YryTRq2b.js";import{u as ze,C as $,a as ce,b as de,c as me,d as pe,e as he}from"./DefaultLayout-CNbVm5ae.js";import{C as z,a as H}from"./CCardBody-BgdPVtOX.js";import{C as xe}from"./CCardHeader-BnYSwQm7.js";import{C as u}from"./CButton-RPa9QO-M.js";import{C as He}from"./CForm-BkonVZOq.js";import{C as o}from"./CFormLabel-B6T8hfcB.js";import{C as d}from"./CFormInput-CplwN3WM.js";import{c as Ue}from"./cil-search-CDkY_4k-.js";import{c as Oe}from"./cil-x-0440B5Ce.js";import{C as ue}from"./CFormCheck-C7HPNWXy.js";import{C as je}from"./CFormSelect-fqNFrf6e.js";import{C as We,a as Je,b as ge,c as b,d as Ke,e as y}from"./CTable-C57A9CG4.js";import{c as Ve}from"./cil-cloud-upload-Ca9_6_ej.js";import{c as Ye}from"./cil-trash-CBbKHhHb.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";import"./emotion-react.browser.esm-Cxtw7Vvq.js";import"./floating-ui.dom-ByRZgDQ1.js";import"./RawMaterial-BtjEDAbB.js";import"./cil-mobile-kffaxYCk.js";import"./CFormControlWrapper-CkuovpMX.js";const Ss=()=>{var Z,ee,se,te;x.useRef({});const[_e,P]=x.useState(!1),[be,U]=x.useState(!1),[O,ye]=x.useState([]),[j,k]=x.useState([]),[fe,B]=x.useState(!1),[h,A]=x.useState(null),[W,L]=x.useState([]),[q,E]=x.useState({name:"",id:null}),[f,C]=x.useState([]),[ve,R]=x.useState(!1),I=x.useRef(null);Pe();const{showToast:m}=qe(),{t:a}=ze("global"),[n,v]=x.useState({project_id:"",name:"",desc:"",expense_id:void 0,typeNotSet:!0,qty:1,price:0,total_price:0,expense_date:new Date().toISOString().split("T")[0],contact:"",payment_by:"",payment_type:"",pending_amount:"",show:!0,isGst:!1,photoAvailable:!0,photo_url:null,photo_remark:"",bank_name:"",acc_number:"",ifsc:"",aadhar:"",pan:"",transaction_id:"",gst:18,sgst:9,cgst:9,igst:0,gstAmount:0,sgstAmount:0,cgstAmount:0,igstAmount:0,baseAmount:0}),D=()=>{const s=localStorage.getItem("i18nextLng"),t=ae.language;return s||t||"en"},J=(s,t=null)=>(t||D())==="mr"&&s.localName||s.name,K=async()=>{try{const s=await ie("/api/expenseType");ye(s.filter(t=>t.show===1))}catch(s){m("danger","Error occurred "+s)}};x.useEffect(()=>{K()},[]),x.useEffect(()=>{K()},[ae.language]);const w=s=>{const t=parseFloat(s.total_price)||0,l=parseFloat(s.gst)||0,r=parseFloat(s.cgst)||0,p=parseFloat(s.sgst)||0,T=parseFloat(s.igst)||0;if(l<=0||t<=0)return s.baseAmount=Number(t.toFixed(2)),s.gstAmount=s.cgstAmount=s.sgstAmount=s.igstAmount=0,s;const S=t/(1+l/100),i=S*(r/100),g=S*(p/100),N=S*(T/100);return s.baseAmount=Number(S.toFixed(2)),s.cgstAmount=Number(i.toFixed(2)),s.sgstAmount=Number(g.toFixed(2)),s.igstAmount=Number(N.toFixed(2)),s.gstAmount=Number((s.cgstAmount+s.sgstAmount+s.igstAmount).toFixed(2)),s},c=s=>{const{name:t,value:l,type:r,checked:p,files:T}=s.target;v(S=>{let i={...S};if(r==="file"&&t==="photo_url")return i.photo_url=T[0]||null,i;if(r==="checkbox"&&t==="isGst")return i.isGst=p,p?w(i):(i.baseAmount=Number((i.total_price||0).toFixed(2)),i.gstAmount=i.cgstAmount=i.sgstAmount=i.igstAmount=0),i;if(r==="checkbox"&&t==="photoAvailable")return i.photoAvailable=p,p||C([]),i;if(t==="price"||t==="qty"){i[t]=l===""?"":l;const g=parseFloat(t==="qty"?l||0:i.qty||0)||0,N=parseFloat(t==="price"?l||0:i.price||0)||0;return i.total_price=Number((g*N).toFixed(2)),i.isGst&&w(i),i}if(t==="total_price")return i.total_price=Number(l||0),i.isGst&&w(i),i;if(t==="gst"){i.gst=Number(l||0);const g=(Number(l)||0)/2;return i.cgst=Number(g.toFixed(2)),i.sgst=Number(g.toFixed(2)),i.isGst&&w(i),i}return["cgst","sgst","igst"].includes(t)?(i[t]=Number(l||0),i.gst=Number(((Number(i.cgst)||0)+(Number(i.sgst)||0)+(Number(i.igst)||0)).toFixed(2)),i.isGst&&w(i),i):(i[t]=r==="checkbox"?p:l,i)})},Ne=s=>{const t=Array.from(s.target.files),l=[];t.forEach(r=>{if(!["image/jpeg","image/jpg","image/png","application/pdf"].includes(r.type)){m("warning",`${r.name} is not a valid file type. Only JPG, PNG, and PDF are allowed.`);return}if(r.size>4096*1024){m("warning",`${r.name} exceeds 4MB size limit.`);return}l.push({file:r,preview:r.type.startsWith("image/")?URL.createObjectURL(r):null,name:r.name,size:(r.size/1024).toFixed(2),type:r.type.includes("pdf")?"pdf":"image",remark:"",id:Date.now()+Math.random()})}),C(r=>[...r,...l]),I.current&&(I.current.value="")},Se=s=>{C(t=>{const l=t.filter(p=>p.id!==s),r=t.find(p=>p.id===s);return r&&r.preview&&URL.revokeObjectURL(r.preview),l})},Le=(s,t)=>{C(l=>l.map(r=>r.id===s?{...r,remark:t}:r))},Ce=async s=>{if(s.length>0)try{const t=await ie(`/api/projects?searchQuery=${s}`);t!=null&&t.length?L(t):L([])}catch(t){m("danger","Error fetching projects: "+t)}else L([])},Ae=s=>{const t=s.target.value;E({name:t,id:null}),Ce(t)},V=s=>{E({name:s.project_name,id:s.id}),v(t=>({...t,project_id:s.id})),L([])},Ee=()=>{if(n.expense_id&&n.price>0&&n.qty>0&&n.project_id){const s=O.find(r=>r.id===parseInt(n.expense_id)),t=D(),l={...n,expense_type_name:s?J(s,t):"Unknown",customer_name:q.name,photos:[...f],id:Date.now()};if(h){const r=j.map(p=>p.id===h.id?{...l,id:h.id}:p);k(r),m("success",a("MSG.expense_updated_successfully")),A(null)}else k([...j,l]),m("success",a("MSG.expense_added_to_list"));F()}else v(s=>({...s,typeNotSet:s.expense_id===void 0})),m("danger",a("MSG.fill_required_fields"))},we=s=>{v({project_id:s.project_id,name:s.name,desc:s.desc||"",expense_id:s.expense_id,typeNotSet:!1,qty:s.qty,price:s.price,total_price:s.total_price,expense_date:s.expense_date,contact:s.contact,payment_by:s.payment_by,payment_type:s.payment_type,pending_amount:s.pending_amount,show:s.show,isGst:s.isGst}),E({name:s.customer_name,id:s.project_id}),C(s.photos||[]),A(s),P(!1),window.scrollTo({top:0,behavior:"smooth"}),m("info",a("MSG.expense_loaded_for_editing"))},Fe=()=>{A(null),F(),m("info",a("MSG.edit_cancelled"))},ke=s=>{const t=j.filter(l=>l.id!==s);k(t),h&&h.id===s&&(A(null),F()),m("info",a("MSG.expense_removed_from_list"))},Be=async s=>{if(s.preventDefault(),s.stopPropagation(),P(!0),n.contact&&!/^\d{10}$/.test(n.contact)){m("danger","Contact number must be exactly 10 digits.");return}if(!n.payment_type){m("danger","Please select payment type");return}if(n.photoAvailable&&f.length===0){m("danger","Please upload at least one photo since 'Photo Available' is checked.");return}const t=new FormData;if(t.append("project_id",n.project_id),t.append("name",n.name),t.append("desc",n.desc||""),t.append("expense_id",n.expense_id),t.append("typeNotSet",n.typeNotSet?1:0),t.append("qty",n.qty),t.append("price",n.price),t.append("total_price",n.total_price),t.append("expense_date",n.expense_date),t.append("contact",n.contact),t.append("payment_by",n.payment_by),t.append("payment_type",n.payment_type),t.append("pending_amount",n.pending_amount),t.append("show",n.show?1:0),t.append("isGst",n.isGst?1:0),t.append("photoAvailable",n.photoAvailable?1:0),t.append("photo_remark",n.photo_remark||""),t.append("bank_name",n.bank_name||""),t.append("acc_number",n.acc_number||""),t.append("ifsc",n.ifsc||""),t.append("transaction_id",n.transaction_id||""),t.append("gst",n.gstAmount||""),t.append("sgst",n.sgstAmount||""),t.append("cgst",n.cgstAmount||""),t.append("igst",n.igstAmount||""),n.photoAvailable&&f.length>0&&f.forEach((l,r)=>{t.append(`photos[${r}]`,l.file),l.remark&&t.append(`photo_remarks[${r}]`,l.remark)}),n.expense_id&&n.price>0&&n.qty>0&&n.project_id)try{await le("/api/expense",t)?m("success",a("MSG.new_expense_added_successfully_msg")):m("danger",a("MSG.error_occured_please_try_again_later_msg")),F()}catch(l){m("danger","Error occurred "+l)}else v(l=>({...l,typeNotSet:l.expense_id===void 0}))},Ge=async()=>{if(j.length===0){m("warning",a("MSG.add_atleast_one_expense"));return}B(!0)},Te=async()=>{try{const s=j.map(r=>{const{id:p,expense_type_name:T,customer_name:S,photos:i,...g}=r,N=new FormData;return Object.keys(g).forEach(_=>{g[_]!==null&&g[_]!==void 0&&g[_]!==""&&N.append(_,g[_])}),r.photoAvailable&&i&&i.length>0&&i.forEach((_,ne)=>{N.append(`photos[${ne}]`,_.file),_.remark&&N.append(`photo_remarks[${ne}]`,_.remark)}),le("/api/expense",N)}),l=(await Promise.all(s)).filter(r=>r).length;if(l===j.length){const r=a("MSG.expenses_submitted_successfully",{count:l})||`${l} expenses submitted successfully`;m("success",r),k([]),A(null)}else{const r=a("MSG.partial_expenses_submitted",{successCount:l,totalCount:j.length})||`${l} out of ${j.length} expenses submitted`;m("warning",r)}}catch(s){const t=a("MSG.error_occurred")||"Error occurred";m("danger",`${t}: ${s}`)}B(!1)},Y=()=>{const s=j.reduce((t,l)=>{const r=parseFloat(l.qty)||0,p=parseFloat(l.price)||0;return t+r*p},0);return Number(s.toFixed(2))},G=s=>`₹${parseFloat(s).toFixed(2)}`,Q=new Date().toISOString().split("T")[0],F=async()=>{v({project_id:"",name:"",desc:"",expense_id:"",qty:"",price:0,total_price:0,expense_date:Q,contact:"",payment_by:"",payment_type:"",pending_amount:"",show:!0,typeNotSet:!1,isGst:!1,photo_remark:"",bank_name:"",acc_number:"",ifsc:"",transaction_id:""}),E({name:"",id:null}),L([]),C([]),P(!1)},Me=D(),X=O.map(s=>({value:s.id,label:J(s,Me)}));return e.jsxs(e.Fragment,{children:[e.jsx(re,{children:e.jsx(oe,{xs:12,children:e.jsxs(z,{className:"mb-4",children:[e.jsx(xe,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("strong",{children:[a(h?"LABELS.edit_expense":"LABELS.new_expense"),h&&e.jsx("span",{className:"ms-2 badge bg-warning text-dark",children:a("LABELS.editing_mode")})]}),e.jsx(u,{color:"danger",size:"sm",onClick:()=>window.location.href="/#/expense/new-type",children:a("LABELS.new_expense_type")})]})}),e.jsx(H,{children:e.jsxs(He,{noValidate:!0,validated:_e,onSubmit:Be,children:[e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-sm-3",style:{position:"relative"},children:[e.jsx(o,{htmlFor:"project_id",children:e.jsx("b",{children:a("LABELS.project_name")})}),e.jsxs("div",{style:{position:"relative"},children:[e.jsx(d,{type:"text",id:"project_id",placeholder:a("LABELS.enter_project_name"),name:"customerName",value:q.name,onChange:Ae,autoComplete:"off",required:!0,feedbackInvalid:a("MSG.customer_name_validation"),style:{paddingRight:"40px"}}),q.name?e.jsx(u,{color:"danger",variant:"outline",onClick:()=>{E({name:""}),L([])},style:{position:"absolute",right:"0",top:"0",bottom:"0",zIndex:5,borderTopLeftRadius:0,borderBottomLeftRadius:0},children:e.jsx(M,{icon:Oe})}):e.jsx(u,{color:"primary",variant:"outline",onClick:()=>U(!0),style:{position:"absolute",right:"0",top:"0",bottom:"0",zIndex:5,borderTopLeftRadius:0,borderBottomLeftRadius:0},children:e.jsx(M,{icon:Ue})})]}),W.length>0&&e.jsx("ul",{className:"suggestions-list",style:{position:"absolute",zIndex:1e3,background:"white",border:"1px solid #ccc",listStyle:"none",padding:0,maxHeight:"200px",overflowY:"auto",width:"100%"},children:W.map(s=>e.jsx("li",{onClick:()=>V(s),style:{padding:"8px",cursor:"pointer",borderBottom:"1px solid #eee"},onMouseEnter:t=>t.target.style.background="#f5f5f5",onMouseLeave:t=>t.target.style.background="white",children:s==null?void 0:s.project_name},s.id))})]}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"",children:[e.jsx(o,{htmlFor:"expense_id",children:e.jsx("b",{children:a("LABELS.expense_type")})}),e.jsx(Re,{id:"expense_id",name:"expense_id",value:X.find(s=>String(s.value)===String(n.expense_id))||null,onChange:s=>v(t=>({...t,expense_id:s?s.value:""})),options:X,placeholder:a("MSG.select_expense_type_msg"),isClearable:!0,isSearchable:!0,styles:{control:s=>({...s,borderRadius:"0.5rem",borderColor:"#ced4da",minHeight:"38px"})}})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"name",children:e.jsx("b",{children:a("LABELS.about_expense")})}),e.jsx(d,{type:"text",id:"name",placeholder:a("LABELS.enter_expense_description"),name:"name",value:n.name,onChange:c})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"expense_date",children:e.jsx("b",{children:a("LABELS.expense_date")})}),e.jsx(d,{type:"date",id:"expense_date",name:"expense_date",max:Q,value:n.expense_date,onChange:c,required:!0,feedbackInvalid:a("MSG.select_date_validation")})]})})]}),e.jsxs("div",{className:"row align-items-end",children:[e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"price",children:e.jsx("b",{children:a("LABELS.price_per_unit")})}),e.jsx(d,{type:"number",min:"0",id:"price",onWheel:s=>s.target.blur(),placeholder:"0.00",step:"0.01",name:"price",onFocus:()=>v(s=>({...s,price:""})),value:n.price,onChange:c,required:!0,feedbackInvalid:a("MSG.price_validation")})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"qty",children:e.jsx("b",{children:a("LABELS.total_units")})}),e.jsx(d,{type:"number",id:"qty",step:"0.01",min:"0",placeholder:" ",name:"qty",value:n.qty,onWheel:s=>s.target.blur(),onKeyDown:s=>{["e","+","-",","].includes(s.key)&&s.preventDefault()},onChange:s=>{const t=s.target.value;(t===""||/^\d+(\.\d{0,2})?$/.test(t))&&c(s)},required:!0,feedbackInvalid:a("MSG.quantity_validation")})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(ue,{id:"isGst",name:"isGst",label:"Is GST Bill",checked:n.isGst,onChange:c}),n.isGst&&e.jsx("small",{className:"text-muted d-block ms-4"})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"total_price",children:e.jsx("b",{children:a("LABELS.total_price")})}),e.jsx(d,{type:"number",min:"0",onWheel:s=>s.target.blur(),id:"total_price",placeholder:"",name:"total_price",value:n.total_price,onChange:c,readOnly:!0})]})})]}),n.isGst&&e.jsxs("div",{className:"row mt-3 p-3 border rounded bg-light mb-3",children:[e.jsxs("div",{className:"col-sm-3",children:[e.jsx(o,{children:e.jsx("b",{children:"Total GST (%)"})}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(d,{type:"number",name:"gst",value:n.gst,onChange:c,min:"0",step:"0.01"}),e.jsx("span",{className:"ms-2",children:"%"})]}),e.jsxs("small",{className:"text-muted",children:["GST Amount: ₹",((Z=n.gstAmount)==null?void 0:Z.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"col-sm-3",children:[e.jsx(o,{children:e.jsx("b",{children:"SGST (%)"})}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(d,{type:"number",name:"sgst",value:n.sgst,onChange:c,min:"0",step:"0.01"}),e.jsx("span",{className:"ms-2",children:"%"})]}),e.jsxs("small",{className:"text-muted",children:["SGST Amount: ₹",((ee=n.sgstAmount)==null?void 0:ee.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"col-sm-3",children:[e.jsx(o,{children:e.jsx("b",{children:"CGST (%)"})}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(d,{type:"number",name:"cgst",value:n.cgst,onChange:c,min:"0",step:"0.01"}),e.jsx("span",{className:"ms-2",children:"%"})]}),e.jsxs("small",{className:"text-muted",children:["CGST Amount: ₹",((se=n.cgstAmount)==null?void 0:se.toFixed(2))||"0.00"]})]}),e.jsxs("div",{className:"col-sm-3",children:[e.jsx(o,{children:e.jsx("b",{children:"IGST (%)"})}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(d,{type:"number",name:"igst",value:n.igst,onChange:c,min:"0",step:"0.01"}),e.jsx("span",{className:"ms-2",children:"%"})]}),e.jsxs("small",{className:"text-muted",children:["IGST Amount: ₹",((te=n.igstAmount)==null?void 0:te.toFixed(2))||"0.00"]})]}),e.jsx("div",{className:"col-12 mt-2",children:e.jsxs("div",{className:"p-2 bg-info-subtle rounded",children:[e.jsx("strong",{children:"Note:"})," Total price remains unchanged. The values above show how much GST/CGST/SGST/IGST are included inside the current total price."]})})]}),e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"contact",children:e.jsx("b",{children:a("LABELS.contact")})}),e.jsx(d,{type:"text",id:"contact",placeholder:a("LABELS.enter_contact"),name:"contact",value:n.contact,onChange:s=>{const t=s.target.value;/^\d{0,10}$/.test(t)&&c(s)},maxLength:10,inputMode:"numeric"})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"payment_by",children:e.jsx("b",{children:a("LABELS.payment_by")})}),e.jsxs(je,{id:"payment_by",name:"payment_by",value:n.payment_by,onChange:c,children:[e.jsx("option",{value:"",children:a("LABELS.select_payment_by")}),Ie.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"payment_type",children:e.jsx("b",{children:a("LABELS.payment_type")})}),e.jsxs(je,{id:"payment_type",name:"payment_type",value:n.payment_type||"",onChange:c,required:!0,feedbackInvalid:"Please select a payment type",children:[e.jsx("option",{value:"",children:"Select Payment Type"}),De.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))]})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"pending_amount",children:e.jsx("b",{children:a("LABELS.pending_amount")})}),e.jsx(d,{type:"number",id:"pending_amount",placeholder:a("LABELS.enter_pending_amount"),name:"pending_amount",value:n.pending_amount,onChange:c})]})})]}),(n.payment_type==="imps"||n.payment_type==="rtgs"||n.payment_type==="NEFT")&&e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"bank_name",children:e.jsx("b",{children:a("LABELS.bank_name")})}),e.jsx(d,{type:"text",id:"bank_name",placeholder:a("LABELS.enter_bank_name"),name:"bank_name",value:n.bank_name,onChange:c})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"acc_number",children:e.jsx("b",{children:a("LABELS.acc_number")})}),e.jsx(d,{type:"text",id:"acc_number",placeholder:a("LABELS.enter_acc_number"),name:"acc_number",value:n.acc_number,onChange:c})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"ifsc",children:e.jsx("b",{children:a("LABELS.ifsc")})}),e.jsx(d,{type:"text",id:"ifsc",placeholder:a("LABELS.enter_ifsc"),name:"ifsc",value:n.ifsc,onChange:c})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"transaction_id",children:e.jsx("b",{children:a("LABELS.transaction_id")})}),e.jsx(d,{type:"text",id:"transaction_id",placeholder:a("LABELS.enter_transaction_id"),name:"transaction_id",value:n.transaction_id,onChange:c})]})})]}),n.payment_type==="upi"&&e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"transaction_id",children:e.jsx("b",{children:a("LABELS.transaction_id")})}),e.jsx(d,{type:"text",id:"transaction_id",placeholder:a("LABELS.enter_transaction_id"),name:"transaction_id",value:n.transaction_id,onChange:c})]})}),n.payment_type==="cheque"&&e.jsxs("div",{className:"row",children:[e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"transaction_id",children:e.jsx("b",{children:"Cheque Number"})}),e.jsx(d,{type:"text",id:"transaction_id",placeholder:"Enter Cheque Number",name:"transaction_id",value:n.transaction_id,onChange:c})]})}),e.jsx("div",{className:"col-sm-3",children:e.jsxs("div",{className:"mb-3",children:[e.jsx(o,{htmlFor:"bank_name",children:e.jsx("b",{children:"Bank Name"})}),e.jsx(d,{type:"text",id:"bank_name",placeholder:"Enter Bank Name",name:"bank_name",value:n.bank_name,onChange:c})]})})]}),e.jsxs("div",{className:"row mt-3",children:[e.jsx("div",{className:"col-sm-3",children:e.jsx(ue,{id:"photoAvailable",name:"photoAvailable",label:"Photo Available",checked:n.photoAvailable,onChange:c})}),n.photoAvailable?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"col-sm-6",children:[e.jsx(o,{htmlFor:"photo_files",children:e.jsx("b",{children:"Upload Photos (JPG, PNG, PDF - Max 4MB each)"})}),e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(d,{ref:I,type:"file",id:"photo_files",name:"photo_files",accept:"image/png, image/jpeg, image/jpg, application/pdf",onChange:Ne,multiple:!0,style:{flex:1}}),f.length>0&&e.jsxs(u,{color:"info",onClick:()=>R(!0),type:"button",children:["Preview (",f.length,")"]})]}),e.jsx("small",{className:"text-muted",children:"You can select multiple files at once"})]})}):e.jsxs("div",{className:"col-sm-6",children:[e.jsx(o,{htmlFor:"photo_remark",children:e.jsx("b",{children:"Photo Remark"})}),e.jsx(d,{type:"text",id:"photo_remark",name:"photo_remark",placeholder:"Enter remark",value:n.photo_remark,onChange:c})]})]}),e.jsxs("div",{className:"mb-3 mt-3",children:[e.jsx(u,{color:"success",type:"submit",children:a("LABELS.submit")})," ",e.jsx(u,{color:"primary",type:"button",onClick:Ee,children:a(h?"LABELS.update_in_list":"LABELS.add_to_list")})," ",h&&e.jsxs(e.Fragment,{children:[e.jsx(u,{color:"warning",type:"button",onClick:Fe,children:a("LABELS.cancel_edit")})," "]}),e.jsx(u,{color:"secondary",onClick:F,children:a("LABELS.clear")})]})]})})]})})}),j.length>0&&e.jsx(re,{children:e.jsx(oe,{xs:12,children:e.jsxs(z,{className:"mb-4",children:[e.jsx(xe,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsxs("strong",{children:[a("LABELS.expenses_list")," (",j.length,")"]}),e.jsxs("span",{children:[a("LABELS.total_amount"),": ",e.jsx("strong",{children:G(Y())})]})]})}),e.jsxs(H,{children:[e.jsx("div",{className:"table-responsive",children:e.jsxs(We,{striped:!0,hover:!0,children:[e.jsx(Je,{children:e.jsxs(ge,{children:[e.jsx(b,{children:a("LABELS.customer_name")}),e.jsx(b,{children:a("LABELS.expense_type")}),e.jsx(b,{children:a("LABELS.description")}),e.jsx(b,{children:a("LABELS.date")}),e.jsx(b,{children:a("LABELS.price")}),e.jsx(b,{children:a("LABELS.quantity")}),e.jsx(b,{children:a("LABELS.total")}),e.jsx(b,{children:"Photos"}),e.jsx(b,{children:a("LABELS.actions")})]})}),e.jsx(Ke,{children:j.map(s=>e.jsxs(ge,{className:h&&h.id===s.id?"table-warning":"",children:[e.jsx(y,{children:s.customer_name}),e.jsx(y,{children:s.expense_type_name}),e.jsx(y,{children:s.name||"-"}),e.jsx(y,{children:s.expense_date}),e.jsx(y,{children:G(s.price)}),e.jsx(y,{children:s.qty}),e.jsx(y,{children:G(s.total_price)}),e.jsx(y,{children:s.photos&&s.photos.length>0?e.jsxs($,{color:"success",children:[s.photos.length," file",s.photos.length>1?"s":""]}):e.jsx($,{color:"secondary",children:"No photos"})}),e.jsxs(y,{children:[e.jsx(u,{color:"info",size:"sm",onClick:()=>we(s),className:"me-1",disabled:h&&h.id===s.id,children:h&&h.id===s.id?a("LABELS.editing"):a("LABELS.edit")}),e.jsx(u,{color:"danger",size:"sm",onClick:()=>ke(s.id),children:a("LABELS.remove")})]})]},s.id))})]})}),e.jsxs("div",{className:"mt-3",children:[e.jsxs(u,{color:"success",size:"lg",onClick:Ge,disabled:h!==null,children:[a("LABELS.submit_all_expenses")," (",j.length,")"]}),h&&e.jsx("div",{className:"mt-2",children:e.jsxs("small",{className:"text-warning",children:[e.jsx("i",{className:"fas fa-exclamation-triangle me-1"}),a("MSG.complete_edit_before_submit")]})})]})]})]})})}),e.jsxs(ce,{visible:fe,onClose:()=>B(!1),children:[e.jsx(de,{children:e.jsx(me,{children:a("LABELS.confirm_submission")})}),e.jsxs(pe,{children:[e.jsx("p",{children:a("MSG.confirm_submit_expenses",{count:j.length})}),e.jsx("p",{children:e.jsxs("strong",{children:[a("LABELS.total_amount"),": ",G(Y().toFixed(2))]})})]}),e.jsxs(he,{children:[e.jsx(u,{color:"secondary",onClick:()=>B(!1),children:a("LABELS.cancel")}),e.jsx(u,{color:"primary",onClick:Te,children:a("LABELS.confirm_submit")})]})]}),e.jsxs(ce,{visible:ve,onClose:()=>R(!1),size:"xl",scrollable:!0,children:[e.jsx(de,{children:e.jsxs(me,{children:["Selected Photos (",f.length,")"]})}),e.jsx(pe,{children:e.jsx("div",{className:"row g-3",children:f.map(s=>e.jsx("div",{className:"col-md-6 col-lg-4",children:e.jsx(z,{className:"h-100",children:e.jsxs(H,{children:[e.jsx("div",{className:"d-flex align-items-center justify-content-center mb-2",style:{height:"200px",backgroundColor:"#f8f9fa",borderRadius:"4px",overflow:"hidden"},children:s.type==="image"?e.jsx("img",{src:s.preview,alt:s.name,style:{maxWidth:"100%",maxHeight:"100%",objectFit:"contain"}}):e.jsxs("div",{className:"text-center",children:[e.jsx(M,{icon:Ve,size:"4xl"}),e.jsx("div",{className:"mt-2",children:e.jsx($,{color:"danger",children:"PDF"})})]})}),e.jsx("div",{className:"mb-2",children:e.jsxs("small",{className:"text-muted",children:[e.jsx("strong",{children:s.name}),e.jsx("br",{}),s.size," KB"]})}),e.jsx(d,{type:"text",placeholder:"Enter remark (optional)",value:s.remark,onChange:t=>Le(s.id,t.target.value),className:"mb-2",size:"sm"}),e.jsxs(u,{color:"danger",size:"sm",onClick:()=>Se(s.id),className:"w-100",children:[e.jsx(M,{icon:Ye})," Remove"]})]})})},s.id))})}),e.jsx(he,{children:e.jsx(u,{color:"secondary",onClick:()=>R(!1),children:"Close"})})]}),e.jsx($e,{visible:be,onClose:()=>U(!1),onSelectProject:V})]})};export{Ss as default};
