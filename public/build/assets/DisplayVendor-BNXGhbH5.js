import{r as i,u as w,b as A,j as e,C as B}from"./index-Cs-5ghpe.js";import{a as F,b as L}from"./api-CIBCEetx.js";import{C as P,a as V}from"./CCardBody-CWVv-Bam.js";import{C as O}from"./CCardHeader-B5GdMtlk.js";import{C as u}from"./CButton-n5jldtHI.js";import{C as $}from"./cil-mobile-CqmbNfnm.js";import{C as H,a as I,b as p,c as o,d as G,e as c}from"./CTable-CVLQWVEb.js";import{a as R,b as q,d as z,e as D}from"./DefaultLayout-05E0ZdWa.js";import{C as U}from"./CForm-BcOVBk6n.js";import{a as h,b as l}from"./index.esm-DS-fhHF9.js";import{C as t}from"./CFormInput-BnDllJdd.js";import"./RawMaterial-BtjEDAbB.js";import"./CFormControlWrapper-fc1Ss_Cu.js";import"./CFormLabel-DHukGEEc.js";const oe=()=>{const[v,N]=i.useState([]),[C,j]=i.useState(!0),[x,k]=i.useState(""),[y,m]=i.useState(!1),[s,f]=i.useState(null),S=w(),{showToast:d}=A();i.useEffect(()=>{g()},[]);const g=()=>{F("/api/operatorsByCompanyId").then(a=>{if(!a)throw new Error("Failed to fetch operators");N(a.filter(n=>n.type==="3")),j(!1)}).catch(a=>{k(a.message),j(!1)})},T=a=>{f({...a,gst_no:a.gst_no||"",bank_name:a.bank_name||"",account_number:a.account_number||"",ifsc_code:a.ifsc_code||"",adhar_number:a.adhar_number||"",pan_number:a.pan_number||""}),m(!0)},r=a=>{const{name:n,value:b}=a.target;let _=b;(n==="gst_no"||n==="pan_number"||n==="ifsc_code")&&(_=b.toUpperCase()),!((n==="mobile"||n==="account_number"||n==="adhar_number")&&!/^\d*$/.test(b))&&f(M=>({...M,[n]:_}))},E=async()=>{if(!s.name.trim()){d("danger","Name is required");return}if(!s.mobile||s.mobile.length!==10){d("danger","Mobile must be 10 digits");return}if(!s.gst_no.trim()){d("danger","GST number required");return}try{await L(`/api/operators/${s.id}`,s),d("success","Vendor updated successfully"),m(!1),g()}catch{d("danger","Failed to update vendor")}};return e.jsxs(P,{className:"mb-4",children:[e.jsxs(O,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Purches Vendor List"}),e.jsx(u,{color:"danger",onClick:()=>S("/NewPurchesVendor"),children:"Add Purches Vendor"})]}),e.jsxs(V,{children:[C&&e.jsx(B,{}),x&&e.jsx($,{color:"danger",children:x}),!C&&!x&&e.jsxs(H,{striped:!0,hover:!0,responsive:!0,children:[e.jsx(I,{children:e.jsxs(p,{children:[e.jsx(o,{children:"#"}),e.jsx(o,{children:"Name"}),e.jsx(o,{children:"Mobile"}),e.jsx(o,{children:"GST No"}),e.jsx(o,{children:"Bank Details"}),e.jsx(o,{children:"Action"})]})}),e.jsx(G,{children:v.map((a,n)=>e.jsxs(p,{children:[e.jsx(o,{children:n+1}),e.jsx(c,{children:a.name}),e.jsx(c,{children:a.mobile}),e.jsx(c,{children:a.gst_no||"-"}),e.jsx(c,{children:a.bank_name&&`${a.bank_name}, Acc: ${a.account_number}, ${a.ifsc_code}`}),e.jsx(c,{children:e.jsx(u,{color:"info",size:"sm",onClick:()=>T(a),children:"Edit"})})]},a.id))})]})]}),e.jsxs(R,{visible:y,onClose:()=>m(!1),size:"lg",children:[e.jsx(q,{children:"Edit Purches Vendor"}),e.jsx(z,{children:s&&e.jsxs(U,{children:[e.jsxs(h,{children:[e.jsx(l,{md:6,children:e.jsx(t,{label:"Name",name:"name",value:s.name,onChange:r})}),e.jsx(l,{md:6,children:e.jsx(t,{label:"Mobile",maxLength:10,name:"mobile",value:s.mobile,onChange:r})})]}),e.jsxs(h,{className:"mt-3",children:[e.jsx(l,{md:6,children:e.jsx(t,{label:"GST Number",name:"gst_no",value:s.gst_no,maxLength:15,onChange:r})}),e.jsx(l,{md:6,children:e.jsx(t,{label:"Aadhar Number",name:"adhar_number",maxLength:12,value:s.adhar_number,onChange:r})})]}),e.jsxs(h,{className:"mt-3",children:[e.jsx(l,{md:6,children:e.jsx(t,{label:"Bank Name",name:"bank_name",value:s.bank_name,onChange:r})}),e.jsx(l,{md:6,children:e.jsx(t,{label:"Account Number",name:"account_number",value:s.account_number,onChange:r})})]}),e.jsxs(h,{className:"mt-3",children:[e.jsx(l,{md:6,children:e.jsx(t,{label:"IFSC Code",name:"ifsc_code",value:s.ifsc_code,onChange:r})}),e.jsx(l,{md:6,children:e.jsx(t,{label:"PAN Number",name:"pan_number",value:s.pan_number,onChange:r})})]})]})}),e.jsxs(D,{children:[e.jsx(u,{color:"secondary",onClick:()=>m(!1),children:"Close"}),e.jsx(u,{color:"primary",onClick:E,children:"Save"})]})]})]})};export{oe as default};
