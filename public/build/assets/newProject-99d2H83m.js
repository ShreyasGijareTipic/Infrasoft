import{r as i,u as N,j as e}from"./index-95D3pMM8.js";import{e as q,g as w,a as F,p as T}from"./api-CIBCEetx.js";import{S as A}from"./react-select.esm-Do7MVeYI.js";import{C as I,a as M}from"./CCardBody-dOzHbfOa.js";import{C as U}from"./CCardHeader-Cq-j3fyp.js";import{C as P}from"./cil-mobile-DjllxSOU.js";import{C as R}from"./CForm-DyhjnECG.js";import{b as a}from"./index.esm-DxutiY6j.js";import{C as n}from"./CFormLabel-C_2Vxs-X.js";import{C as l}from"./CFormInput-C_VETgxc.js";import{C as B}from"./CFormCheck-Ct4OionT.js";import{C as G}from"./CFormTextarea-B-FmTaE-.js";import{C as S}from"./CButton-B_ZYbnJ4.js";import"./defineProperty-DJACW-dl.js";import"./typeof-QjJsDpFa.js";import"./emotion-react.browser.esm-BRdyIXV2.js";import"./floating-ui.dom-ByRZgDQ1.js";import"./CFormControlWrapper-DhbFIWP9.js";const ne=()=>{const[t,p]=i.useState({customer_name:"",mobile_number:"",project_name:"",project_cost:"",supervisor_id:"",work_place:"",commission:"",start_date:"",end_date:"",is_visible:!0,remark:"",gst_number:"",pan_number:""}),[g,m]=i.useState({}),[b,_]=i.useState(""),[v,f]=i.useState([]),[y,h]=i.useState(!1),E=N(),j=q(),x=w(),C=x==null?void 0:x.id;i.useEffect(()=>{j===2&&C&&p(r=>({...r,supervisor_id:C})),k()},[j,C]);const k=async()=>{try{const r=await F("/api/usersData");f((r==null?void 0:r.users)||[])}catch(r){console.error("Error fetching users:",r),f([])}},s=r=>{const{name:o,value:d,type:u,checked:c}=r.target;p({...t,[o]:u==="checkbox"?c:d})},D=async r=>{var o,d,u;if(r.preventDefault(),m({}),_(""),h(!0),t.end_date&&t.start_date&&new Date(t.end_date)<new Date(t.start_date)){m({end_date:"End date must be after or equal to start date."}),h(!1);return}try{await T("/api/storeManually",t),_("Project created successfully!"),E("/project")}catch(c){console.error("Error creating project:",c),(o=c.response)!=null&&o.data.errors?m(c.response.data.errors):m({general:((u=(d=c.response)==null?void 0:d.data)==null?void 0:u.message)||"Failed to create project."})}finally{h(!1)}};return e.jsx("div",{className:"container-lg p-2",children:e.jsxs(I,{children:[e.jsx(U,{children:"Create New Project"}),e.jsxs(M,{children:[b&&e.jsx(P,{color:"success",children:b}),g.general&&e.jsx(P,{color:"danger",children:g.general}),e.jsx(R,{onSubmit:D,children:e.jsxs("div",{className:"row g-3",children:[e.jsxs(a,{md:4,children:[e.jsx(n,{children:"Customer Name"}),e.jsx(l,{type:"text",name:"customer_name",value:t.customer_name,onChange:s,required:!0,placeholder:"Enter Customer Name..."})]}),e.jsxs(a,{md:4,children:[e.jsx(n,{children:"Customer Mobile Number"}),e.jsx(l,{type:"text",name:"mobile_number",value:t.mobile_number,onChange:r=>{const o=r.target.value.replace(/\D/g,"");o.length<=10&&s({target:{name:"mobile_number",value:o}})},required:!0,placeholder:"Enter Customer Mobile..."})]}),e.jsxs(a,{md:4,children:[e.jsx(n,{children:"GST number"}),e.jsx(l,{type:"text",name:"gst_number",value:t.gst_number,onChange:s,required:!0,placeholder:"Enter GST number..."})]}),e.jsxs(a,{md:4,children:[e.jsx(n,{children:"Pan Card number"}),e.jsx(l,{type:"text",name:"pan_number",value:t.pan_number,onChange:s,required:!0,placeholder:"Enter Pan Card number..."})]}),e.jsxs(a,{md:4,children:[e.jsx(n,{children:"Project Name"}),e.jsx(l,{type:"text",name:"project_name",value:t.project_name,onChange:s,required:!0,placeholder:"Enter Project Name..."})]}),e.jsxs(a,{md:4,children:[e.jsx(n,{children:"Project Cost"}),e.jsx(l,{type:"number",name:"project_cost",value:t.project_cost,onChange:s,required:!0,placeholder:"Enter Project cost..."})]}),e.jsxs(a,{md:4,children:[e.jsx(n,{children:"Work Place"}),e.jsx(l,{type:"text",name:"work_place",value:t.work_place,onChange:s,required:!0,placeholder:"Enter Work Place Address..."})]}),j===1&&e.jsxs(a,{md:6,children:[e.jsx(n,{children:"Supervisor"}),e.jsx(A,{options:v.map(r=>({value:r.id,label:r.name})),value:v.map(r=>({value:r.id,label:r.name})).find(r=>r.value===t.supervisor_id)||null,onChange:r=>p(o=>({...o,supervisor_id:r?r.value:""}))})]}),e.jsxs(a,{md:6,children:[e.jsx(n,{children:"Commission"}),e.jsx(l,{type:"text",name:"commission",value:t.commission,onChange:r=>{const o=r.target.value.replace(/[^0-9.:]/g,"");s({target:{name:"commission",value:o}})},required:!0,placeholder:"Enter Oprator Comission ( Per Point )"})]}),e.jsxs(a,{md:6,children:[e.jsx(n,{children:"Start Date"}),e.jsx(l,{type:"date",name:"start_date",value:t.start_date,onChange:s})]}),e.jsxs(a,{md:6,children:[e.jsx(n,{children:"End Date"}),e.jsx(l,{type:"date",name:"end_date",value:t.end_date,onChange:s})]}),e.jsx(a,{xs:12,children:e.jsx(B,{id:"is_visible",name:"is_visible",checked:t.is_visible,onChange:s,label:"Is Visible"})}),e.jsxs(a,{xs:12,children:[e.jsx(n,{children:"Remark"}),e.jsx(G,{name:"remark",value:t.remark,onChange:s,placeholder:"Enter Remark About Project"})]}),e.jsxs(a,{xs:12,children:[e.jsx(S,{type:"submit",color:"primary",disabled:y,children:y?"Submitting...":"Create Project"}),e.jsx(S,{type:"button",color:"secondary",className:"ms-2",onClick:()=>E("/project"),children:"Cancel"})]})]})})]})]})})};export{ne as default};
