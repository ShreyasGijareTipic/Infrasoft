import{r as a,b as K,j as e,C as k}from"./index-DaQ8IcWH.js";import{u as V,M as _}from"./mantine-react-table.esm-IgVZKypG.js";import{a as D}from"./api-CIBCEetx.js";import{C as p}from"./DefaultLayout-CNbVm5ae.js";import{C as N,a as S}from"./CCardBody-BgdPVtOX.js";import{C as I}from"./CCardHeader-BnYSwQm7.js";import{C as M}from"./CForm-BkonVZOq.js";import{a as B,b as u}from"./index.esm-W-SaLQ2H.js";import{C as H}from"./CFormInput-CplwN3WM.js";import{C as L}from"./CFormSelect-fqNFrf6e.js";import{C as c}from"./CButton-RPa9QO-M.js";import{C as G}from"./cil-mobile-kffaxYCk.js";import"./Table-B97Nt8_1.js";import"./MantineProvider-DbsqmQvK.js";import"./emotion-react.browser.esm-Cxtw7Vvq.js";import"./floating-ui.dom-ByRZgDQ1.js";import"./RawMaterial-BtjEDAbB.js";import"./CFormControlWrapper-CkuovpMX.js";import"./CFormLabel-B6T8hfcB.js";const ce=()=>{const[v,h]=a.useState([]),[r,x]=a.useState(!0),[t,i]=a.useState(1),[d,F]=a.useState(1),[m,w]=a.useState(0),[o,g]=a.useState(""),[n,f]=a.useState(""),[j,C]=a.useState(""),{showToast:R}=K(),y=async()=>{x(!0),C("");try{const s=new URLSearchParams({page:t.toString(),...o&&{search:o},...n&&{status:n}}),l=await D(`/api/company-receipts?${s}`);if(l.success)h(l.data.data||[]),F(l.data.last_page||1),w(l.data.total||0);else throw new Error(l.message||"Failed to fetch receipts")}catch(s){console.error("Error fetching company receipts:",s),C("Error fetching company receipts. Please try again."),R("danger","Error fetching company receipts"),h([])}finally{x(!1)}};a.useEffect(()=>{y()},[t,o,n]);const z=s=>{g(s),i(1)},P=s=>{f(s),i(1)},T=()=>{g(""),f(""),i(1)},A=a.useMemo(()=>[{accessorKey:"id",header:"Receipt ID",size:100,Cell:({row:s})=>e.jsxs("span",{className:"fw-bold text-primary",children:["#",s.original.id]})},{accessorKey:"company.company_name",header:"Company Name",size:200,Cell:({cell:s})=>e.jsx("div",{children:e.jsx("div",{className:"fw-semibold",children:s.getValue()||"N/A"})})},{accessorKey:"company.phone_no",header:"Mobile",size:130,Cell:({cell:s})=>e.jsx("span",{className:"text-muted",children:s.getValue()||"N/A"})},{accessorKey:"company.email_id",header:"Email",size:200,Cell:({cell:s})=>e.jsx("span",{className:"text-muted small",children:s.getValue()||"N/A"})},{accessorKey:"plan.name",header:"Plan",size:150,Cell:({cell:s,row:l})=>{var b;return e.jsxs("div",{children:[e.jsx("div",{className:"fw-semibold",children:s.getValue()||"N/A"}),((b=l.original.plan)==null?void 0:b.duration)&&e.jsxs("small",{className:"text-muted",children:[l.original.plan.duration," days"]})]})}},{accessorKey:"register_date",header:"Register Date",size:150,Cell:({cell:s})=>e.jsx("div",{className:"fw-semibold",children:s.getValue()||"N/A"})},{accessorKey:"total_amount",header:"Amount",size:120,Cell:({cell:s})=>e.jsxs("span",{className:"fw-bold text-success",children:["â‚¹",parseFloat(s.getValue()||0).toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})},{accessorKey:"transaction_id",header:"Transaction ID",size:180,Cell:({cell:s})=>e.jsx("code",{className:"small bg-light p-1 rounded",children:s.getValue()||"N/A"})},{accessorKey:"transaction_status",header:"Status",size:100,Cell:({cell:s})=>s.getValue()==="success"?e.jsx(p,{color:"success",shape:"rounded-pill",children:"Success"}):e.jsx(p,{color:"danger",shape:"rounded-pill",children:"Failed"})}],[]),E=V({columns:A,data:v,enableStickyHeader:!0,enableStickyFooter:!0,enableDensityToggle:!1,enableColumnResizing:!0,enableFullScreenToggle:!1,enableGlobalFilter:!1,enableColumnFilters:!1,enableSorting:!1,enablePagination:!1,mantineTableProps:{striped:!0,highlightOnHover:!0,withBorder:!0,withColumnBorders:!1},mantineTableHeadCellProps:{style:{fontWeight:"bold",backgroundColor:"#f8f9fa"}},state:{isLoading:r},renderEmptyRowsFallback:()=>e.jsx("div",{className:"text-center py-4",children:e.jsx("div",{className:"text-muted",children:j?e.jsx(G,{color:"danger",className:"mb-0",children:j}):"No receipts found"})})});return e.jsxs(N,{children:[e.jsx(I,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("h5",{className:"mb-0",children:"Company Receipts"}),e.jsxs(p,{color:"info",shape:"rounded-pill",children:["Total: ",m]})]})}),e.jsxs(S,{children:[e.jsx(N,{className:"mb-4 border-0 bg-light",children:e.jsx(S,{children:e.jsx(M,{children:e.jsxs(B,{className:"g-3",children:[e.jsx(u,{md:4,children:e.jsx(H,{type:"text",placeholder:"Search by company, email, transaction ID...",value:o,onChange:s=>z(s.target.value),className:"form-control-sm"})}),e.jsx(u,{md:3,children:e.jsxs(L,{value:n,onChange:s=>P(s.target.value),className:"form-select-sm",children:[e.jsx("option",{value:"",children:"All Status"}),e.jsx("option",{value:"success",children:"Success"}),e.jsx("option",{value:"failed",children:"Failed"})]})}),e.jsx(u,{md:5,children:e.jsxs("div",{className:"d-flex gap-2",children:[e.jsx(c,{color:"secondary",variant:"outline",size:"sm",onClick:T,disabled:!o&&!n,children:"Clear Filters"}),e.jsxs(c,{color:"primary",size:"sm",onClick:y,disabled:r,children:[r?e.jsx(k,{size:"sm",className:"me-2"}):null,"Refresh"]})]})})]})})})}),e.jsx("div",{className:"table-responsive",children:e.jsx(_,{table:E})}),d>1&&e.jsxs("div",{className:"d-flex justify-content-between align-items-center mt-4",children:[e.jsxs("div",{className:"text-muted small",children:["Showing ",(t-1)*25+1," to ",Math.min(t*25,m)," of ",m," entries"]}),e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx(c,{color:"primary",variant:"outline",size:"sm",disabled:t===1||r,onClick:()=>i(t-1),children:"Previous"}),e.jsxs("span",{className:"px-3 py-1 bg-light rounded small",children:["Page ",t," of ",d]}),e.jsx(c,{color:"primary",variant:"outline",size:"sm",disabled:t>=d||r,onClick:()=>i(t+1),children:"Next"})]})]})]})]})};export{ce as default};
