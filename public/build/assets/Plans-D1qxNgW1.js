import{b as M,r as p,j as e}from"./index-RpBzfmRP.js";import{p as D,b as G,a as H,d as z}from"./api-CIBCEetx.js";import{u as E,a as y,b as A,c as k,d as w,e as R}from"./DefaultLayout-8YNBKV_4.js";import{C as F}from"./CForm-HJD6m-Ck.js";import{C as f}from"./CFormLabel-CbpozHkd.js";import{C as b}from"./CFormInput-DA1SntO8.js";import{C as x}from"./CButton-L7dQWiht.js";import{a as $,b as U}from"./index.esm-DUetlGrP.js";import{C as J,a as K}from"./CCardBody-CXkOMOvY.js";import{C as O}from"./CCardHeader-eGsVFHQg.js";import{C as Q,a as W,b as N,c as _,d as X,e as C}from"./CTable-CQX9REJw.js";import{C as Y}from"./CFormSwitch-zFHh-khp.js";import"./RawMaterial-BtjEDAbB.js";import"./cil-mobile-BmZiFZXB.js";import"./CFormControlWrapper-D2DOCb2Z.js";function Z({visible:L,setVisible:d,onSuccess:g}){const{showToast:r}=M(),{t:a}=E("global"),[i,o]=p.useState({name:"",description:"",price:0,userLimit:0,accessLevel:1,isActive:!0}),t=c=>{const{name:m,value:l}=c.target;o({...i,[m]:l})},j=async c=>{c.preventDefault();const m=c.target;if(!m.checkValidity()){m.classList.add("was-validated");return}let l={...i};try{const n=await D("/api/plan",l);n!=null&&n.id?(r("success",a("MSG.data_saved_successfully_msg")),g(n),d(!1),v()):r("danger",a("MSG.failed_to_create"))}catch(n){r("danger","Error occured "+n)}},v=()=>{o({name:"",description:"",price:0,userLimit:0,accessLevel:1,isActive:!0})};return e.jsx(e.Fragment,{children:e.jsxs(y,{backdrop:"static",visible:L,onClose:()=>{v(),d(!1)},"aria-labelledby":"StaticBackdropExampleLabel",children:[e.jsx(A,{children:e.jsx(k,{id:"StaticBackdropExampleLabel",children:a("LABELS.new_plan")})}),e.jsx(w,{children:e.jsxs(F,{className:"needs-validation",noValidate:!0,onSubmit:j,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"pname",children:a("LABELS.plan_name")}),e.jsx(b,{type:"text",id:"pname",placeholder:a("MSG.plan_name"),name:"name",value:i.name,onChange:t,required:!0,feedbackInvalid:a("MSG.please_provide_plan_name"),feedbackValid:a("MSG.looks_good_msg")}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.name_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"plmobile",children:a("LABELS.plan_description")}),e.jsx(b,{type:"text",id:"description",placeholder:a("MSG.enter_description_msg"),name:"description",value:i.description,onChange:t,required:!0,feedbackInvalid:a("MSG.please_provide_description_msg"),feedbackValid:a("MSG.looks_good_msg")}),e.jsx("div",{className:"invalid-feedback",children:a("MSG.mobile_description_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"price",children:a("LABELS.price")}),e.jsx(b,{type:"number",id:"price",placeholder:"",name:"price",value:i.price,onChange:t})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"userLimit",children:a("LABELS.user_limit")}),e.jsx(b,{type:"number",id:"userLimit",placeholder:"",name:"userLimit",value:i.userLimit,onChange:t})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{color:"success",type:"submit",children:a("LABELS.submit")})," ",e.jsx(x,{color:"danger",onClick:()=>{v(),d(!1)},children:a("LABELS.close")})]})]})})]})})}function ee({visible:L,setVisible:d,onSuccess:g,planData:r}){const{showToast:a}=M(),{t:i}=E("global"),[o,t]=p.useState({name:"",description:"",price:0,userLimit:0,accessLevel:1,isActive:!0});p.useEffect(()=>{L&&r&&t({name:r.name||"",description:r.description||"",price:r.price||0,userLimit:r.userLimit||0,accessLevel:r.accessLevel||1,isActive:r.isActive===1})},[L,r]);const j=m=>{const{name:l,value:n}=m.target;t({...o,[l]:n})},v=async m=>{m.preventDefault();const l=m.target;if(!l.checkValidity()){l.classList.add("was-validated");return}let n={...o,isActive:o.isActive?1:0};try{const h=await G(`/api/plan/${r.id}`,n);h!=null&&h.id||h?(a("success",i("MSG.data_updated_successfully_msg")),g(h),d(!1),c()):a("danger",i("MSG.failed_to_update"))}catch(h){a("danger","Error occurred "+h)}},c=()=>{t({name:"",description:"",price:0,userLimit:0,accessLevel:1,isActive:!0})};return e.jsx(e.Fragment,{children:e.jsxs(y,{backdrop:"static",visible:L,onClose:()=>{c(),d(!1)},"aria-labelledby":"EditPlanModalLabel",children:[e.jsx(A,{children:e.jsx(k,{id:"EditPlanModalLabel",children:i("LABELS.edit_plan")})}),e.jsx(w,{children:e.jsxs(F,{className:"needs-validation",noValidate:!0,onSubmit:v,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"edit_pname",children:i("LABELS.plan_name")}),e.jsx(b,{type:"text",id:"edit_pname",placeholder:i("MSG.plan_name"),name:"name",value:o.name,onChange:j,required:!0,feedbackInvalid:i("MSG.please_provide_plan_name"),feedbackValid:i("MSG.looks_good_msg")}),e.jsx("div",{className:"invalid-feedback",children:i("MSG.name_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"edit_description",children:i("LABELS.plan_description")}),e.jsx(b,{type:"text",id:"edit_description",placeholder:i("MSG.enter_description_msg"),name:"description",value:o.description,onChange:j,required:!0,feedbackInvalid:i("MSG.please_provide_description_msg"),feedbackValid:i("MSG.looks_good_msg")}),e.jsx("div",{className:"invalid-feedback",children:i("MSG.mobile_description_is_required_msg")})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"edit_price",children:i("LABELS.price")}),e.jsx(b,{type:"number",id:"edit_price",placeholder:"",name:"price",value:o.price,onChange:j})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(f,{htmlFor:"edit_userLimit",children:i("LABELS.user_limit")}),e.jsx(b,{type:"number",id:"edit_userLimit",placeholder:"",name:"userLimit",value:o.userLimit,onChange:j})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(x,{color:"success",type:"submit",children:i("LABELS.update")})," ",e.jsx(x,{color:"danger",onClick:()=>{c(),d(!1)},children:i("LABELS.close")})]})]})})]})})}function je(){const[L,d]=p.useState([]),[g,r]=p.useState(!1),[a,i]=p.useState(!1),[o,t]=p.useState(!1),[j,v]=p.useState(null),[c,m]=p.useState(null),{t:l}=E("global"),{showToast:n}=M(),h=async()=>{try{const s=await H("/api/plan");d(s)}catch(s){console.error("Error fetching Plans:",s)}};p.useEffect(()=>{h()},[]);const P=async s=>{const u={...s,isActive:s.isActive===1?0:1};try{await G("/api/plan/"+u.id,u),d(S=>S.map(B=>B.id===s.id?u:B))}catch(S){console.error("Error updating plan:",S)}},T=s=>{v(s),i(!0)},q=s=>{m(s),t(!0)},I=async()=>{try{await z(`/api/plan/${c.id}`),d(s=>s.filter(u=>u.id!==c.id)),n("success",l("MSG.data_deleted_successfully_msg")),t(!1),m(null)}catch(s){console.error("Error deleting plan:",s),n("danger","Error occurred while deleting plan")}},V=s=>{d(u=>u.map(S=>S.id===s.id?s:S))};return e.jsxs($,{children:[e.jsx(Z,{onSuccess:h,visible:g,setVisible:r}),e.jsx(ee,{onSuccess:V,visible:a,setVisible:i,planData:j}),e.jsxs(y,{backdrop:"static",visible:o,onClose:()=>t(!1),"aria-labelledby":"DeleteConfirmationModalLabel",children:[e.jsx(A,{children:e.jsx(k,{id:"DeleteConfirmationModalLabel",children:l("LABELS.confirm_delete")})}),e.jsxs(w,{children:[l("MSG.are_you_sure_delete_plan"),' "',c==null?void 0:c.name,'"?']}),e.jsxs(R,{children:[e.jsx(x,{color:"danger",onClick:I,children:l("LABELS.delete")}),e.jsx(x,{color:"secondary",onClick:()=>t(!1),children:l("LABELS.cancel")})]})]}),e.jsx(U,{xs:12,children:e.jsxs(J,{className:"mb-4",children:[e.jsx(O,{children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"All Plans"}),e.jsx(x,{size:"sm",color:"primary",onClick:()=>r(!0),children:"New"})]})}),e.jsx(K,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs(Q,{children:[e.jsx(W,{children:e.jsxs(N,{children:[e.jsx(_,{scope:"col",children:"Id"}),e.jsx(_,{scope:"col",children:"Name"}),e.jsx(_,{scope:"col",children:"Description"}),e.jsx(_,{scope:"col",children:"Price"}),e.jsx(_,{scope:"col",children:"User Limit"}),e.jsx(_,{scope:"col",children:"Active"}),e.jsx(_,{scope:"col",children:"Actions"})]})}),e.jsx(X,{children:L.map((s,u)=>e.jsxs(N,{children:[e.jsx(_,{scope:"row",children:u+1}),e.jsx(C,{children:s.name}),e.jsx(C,{children:s.description}),e.jsx(C,{children:s.price}),e.jsx(C,{children:s.userLimit}),e.jsx(C,{children:e.jsx(Y,{id:`formSwitchCheckDefault${s.id}`,checked:s.isActive===1,onChange:()=>P(s)})}),e.jsxs(C,{children:[e.jsx(x,{color:"info",variant:"outline",size:"sm",onClick:()=>T(s),className:"me-2",children:l("LABELS.edit")}),e.jsx(x,{color:"danger",variant:"outline",size:"sm",onClick:()=>q(s),children:l("LABELS.delete")})]})]},s.id))})]})})})]})})]})}export{je as default};
