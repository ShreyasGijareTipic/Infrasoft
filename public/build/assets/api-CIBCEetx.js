const l="userData";function y(t){try{return t?JSON.parse(t):null}catch(r){return console.warn("Failed to parse stored user data:",r),null}}function f(){try{const t="__localStorage_test__";return localStorage.setItem(t,t),localStorage.removeItem(t),!0}catch(t){return console.warn("localStorage is not available:",t),!1}}function d(t){return t&&typeof t=="object"&&t.token&&(t.user||t.partner)}function g(t){if(!f())return console.error("localStorage is not available"),!1;if(!d(t))return console.error("Invalid user data provided"),!1;try{const r={...t,_timestamp:Date.now()};return localStorage.setItem(l,JSON.stringify(r)),!0}catch(r){return console.error("Failed to store user data:",r),!1}}function c(){if(!f())return null;try{const t=localStorage.getItem(l),r=y(t);return!r||typeof r!="object"?(console.warn("Invalid or corrupted user data found"),p(),null):r}catch(t){return console.error("Error retrieving user data:",t),null}}function p(){if(!f())return!1;try{return localStorage.removeItem(l),!0}catch(t){return console.error("Failed to delete user data:",t),!1}}function h(){const t=c();return!!(t&&t.token&&(t.user||t.partner))}function m(){return h()}function i(){const t=c();return(t==null?void 0:t.token)??null}function E(){var r,e;const t=c();return((r=t==null?void 0:t.user)==null?void 0:r.type)??((e=t==null?void 0:t.partner)==null?void 0:e.type)??null}function S(){const t=c();return(t==null?void 0:t.user)??(t==null?void 0:t.partner)??null}const n="";async function T(t){return await a(n+"/api/register",t)}async function j(t="",r){try{const e=i(),o=await fetch(t,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${e}`},body:r});return o.ok||await u(o,t),o.json()}catch(e){throw console.error("Error posting form data:",e),e}}async function k(t="",r){try{const e=i(),o=await fetch(t,{method:"POST",headers:{Accept:"application/json",Authorization:`Bearer ${e}`},body:r});return o.ok||await u(o,t),o.json()}catch(e){throw console.error("Error posting form data:",e),e}}async function a(t="",r={},e="POST"){try{const o=i(),s=await fetch(t,{method:e,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${o}`},body:JSON.stringify(r)});return s.ok||await u(s,t),s.json()}catch(o){throw console.error(`Error with ${e} request to ${t}:`,o),o}}async function w(t="",r="GET"){try{const e=i(),o=await fetch(t,{method:r,headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:`Bearer ${e}`}});return o.ok||await u(o,t),o.json()}catch(e){throw console.error(`Error with ${r} request to ${t}:`,e),e}}async function u(t,r){if(t.status===401&&!r.includes("/login")){p(),window.location.replace("/");return}let e=null;try{e=await t.json()}catch{throw new Error(`HTTP error! status: ${t.status}`)}const o=new Error(e.message||`HTTP error! status: ${t.status}`);throw o.response={status:t.status,data:e},o}async function A(){return await a(n+"/api/logout")}async function v(){return await a(n+"/api/logoutEverywhere")}async function I(t,r){return await a(n+t,r)}async function P(t,r){return await a(n+t,r,"PUT")}async function O(t,r){return await a(n+t,r)}async function $(t){return await w(n+t)}async function b(t){return await w(n+t,"DELETE")}export{$ as a,P as b,j as c,b as d,E as e,O as f,S as g,n as h,m as i,k as j,p as k,A as l,v as m,I as p,T as r,g as s};
