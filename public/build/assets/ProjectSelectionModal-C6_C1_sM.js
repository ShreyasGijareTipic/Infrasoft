import{r,j as e,C as k}from"./index-95D3pMM8.js";import{a as T}from"./api-CIBCEetx.js";import{a as v,b as N,c as w,d as M,e as E}from"./DefaultLayout-CJHw--2-.js";import{C as P}from"./CFormInput-C_VETgxc.js";import{C as H,a as B,b as x,c as i,d as D,e as l}from"./CTable-E2GxfeJ9.js";import{C as f}from"./CButton-B_ZYbnJ4.js";const z=({visible:d,onClose:y,onSelectProject:u})=>{const[m,C]=r.useState([]),[t,j]=r.useState(""),[S,p]=r.useState(!1),[a,h]=r.useState(null),c=r.useCallback(async s=>{p(!0);try{const o=await T(`/api/projects?searchQuery=${s}`);C(o||[])}catch(o){console.error("Error fetching projects:",o),C([])}finally{p(!1)}},[]);r.useEffect(()=>{d&&c("")},[d,c]),r.useEffect(()=>{const s=setTimeout(()=>{c(t)},300);return()=>clearTimeout(s)},[t,c]);const b=()=>{a&&(u(a),n())},n=()=>{j(""),h(null),y()},g=s=>{u(s),n()};return e.jsxs(v,{visible:d,onClose:n,size:"lg",backdrop:"static",children:[e.jsx(N,{children:e.jsx(w,{children:"Select Project"})}),e.jsxs(M,{children:[e.jsx("div",{className:"mb-3",children:e.jsx(P,{type:"text",placeholder:"Search projects...",value:t,onChange:s=>j(s.target.value),autoFocus:!0})}),S?e.jsx("div",{className:"text-center py-4",children:e.jsx(k,{color:"primary"})}):e.jsx("div",{style:{maxHeight:"400px",overflowY:"auto"},children:e.jsxs(H,{hover:!0,responsive:!0,children:[e.jsx(B,{children:e.jsxs(x,{children:[e.jsx(i,{style:{width:"50px"},children:"Select"}),e.jsx(i,{children:"Project Name"}),e.jsx(i,{children:"Customer Name"}),e.jsx(i,{children:"Location"})]})}),e.jsx(D,{children:m.length>0?m.map(s=>{var o;return e.jsxs(x,{style:{cursor:"pointer"},onClick:()=>h(s),onDoubleClick:()=>g(s),className:(a==null?void 0:a.id)===s.id?"table-active":"",children:[e.jsx(l,{children:e.jsx("input",{type:"radio",name:"projectSelection",checked:(a==null?void 0:a.id)===s.id,onChange:()=>h(s)})}),e.jsx(l,{children:s.project_name}),e.jsx(l,{children:s.customer_name||((o=s.customer)==null?void 0:o.name)||"-"}),e.jsx(l,{children:s.work_place||s.location||"-"})]},s.id)}):e.jsx(x,{children:e.jsx(l,{colSpan:"4",className:"text-center",children:t?"No projects found":"Loading projects..."})})})]})})]}),e.jsxs(E,{children:[e.jsx(f,{color:"secondary",onClick:n,children:"Cancel"}),e.jsx(f,{color:"primary",onClick:b,disabled:!a,children:"Select Project"})]})]})};export{z as P};
