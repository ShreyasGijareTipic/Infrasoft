import{r as s,u as le,b as ce,j as e}from"./index-C2yVeD7S.js";import{C as de,a as me,b as pe,c as n}from"./index.esm-BfesGHR4.js";import{a as ue,f as fe}from"./api-CIBCEetx.js";import{C as he,a as xe}from"./CCardBody-D-jAy6vr.js";import{C as be}from"./CCardHeader-6bNqU1xa.js";import{C as ge}from"./CForm-9WpppnGX.js";import{C as l}from"./CInputGroup-Dl8FeEzY.js";import{C as i}from"./CInputGroupText-BfFQ-DqL.js";import{c as ve}from"./cil-people-DQU-yEHN.js";import{C as Ce}from"./CFormSelect-Cs5qoCpd.js";import{c as je}from"./RawMaterial-BtjEDAbB.js";import{C as m}from"./CFormInput-CXoXZ5N_.js";import{c as ye,a as we}from"./cil-envelope-closed-B4Yc6MaR.js";import{c as Pe,a as X}from"./cil-mobile-YEmBCbC2.js";import{c as Ie}from"./cil-credit-card-KG5pHjdT.js";import{k as Re}from"./DefaultLayout-BQzMumzV.js";import{C as Ne}from"./CButton-pXUvGqWL.js";import"./CFormControlWrapper-D7XNeBGJ.js";import"./CFormLabel-eLpXnSYX.js";const ze=()=>{const[Y,j]=s.useState(!1),[ee,y]=s.useState([]),[ae,b]=s.useState(!1),[c,d]=s.useState({}),[f,w]=s.useState(!1),[h,P]=s.useState(!1);le();const I=s.useRef(),R=s.useRef(),N=s.useRef(),S=s.useRef(),k=s.useRef(),x=s.useRef(),_=s.useRef(),E=s.useRef(),T=s.useRef(),{showToast:p}=ce();s.useEffect(()=>{try{ue("/api/partner-types").then(a=>{if(a!=null&&a.length){const r=a.map(o=>({label:o.partner_type,value:o.id}));y([{label:"Select Partner Type",value:""},...r])}}).catch(a=>{console.error("Error fetching partner types:",a),y([{label:"Select Partner Type",value:""},{label:"Sales Partner",value:"1"},{label:"Service Partner",value:"2"},{label:"Distribution Partner",value:"3"}])})}catch(a){p("danger","Error loading partner types: "+a)}},[]);const re=()=>{const a=parseInt(x.current.value,10);b(!(a>0)),a>0&&d(r=>({...r,type_id:""}))},q=a=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a),F=a=>/^[0-9]{10}$/.test(a),B=a=>/^[A-Z]{4}0[A-Z0-9]{6}$/.test(a.toUpperCase()),g=(a,r)=>{let o="";switch(a){case"email":r&&!q(r)&&(o="Please enter a valid email address");break;case"mobile":r&&!F(r)&&(o="Mobile number must be exactly 10 digits");break;case"ifsc_code":r&&!B(r)&&(o="Please enter a valid IFSC code (e.g., SBIN0000123)");break}d(u=>({...u,[a]:o}))},se=()=>{w(!f)},te=()=>{P(!h)},oe=async a=>{var D,M,V,U,H,O,$,G,Z,z,J,K,Q,W;a.preventDefault(),a.stopPropagation();const r=a.currentTarget;let o=!1;const u=(D=R.current)==null?void 0:D.value;(!u||!q(u))&&(d(t=>({...t,email:"Please enter a valid email address"})),o=!0);const v=(M=N.current)==null?void 0:M.value;(!v||!F(v))&&(d(t=>({...t,mobile:"Mobile number must be exactly 10 digits"})),o=!0);const C=(V=T.current)==null?void 0:V.value;if((!C||!B(C))&&(d(t=>({...t,ifsc_code:"Please enter a valid IFSC code"})),o=!0),r.checkValidity()===!1||o){j(!0);return}const L=(U=S.current)==null?void 0:U.value,A=(H=k.current)==null?void 0:H.value;if(L!==A){p("danger","Passwords do not match"),d(t=>({...t,password_confirmation:"Passwords do not match"}));return}if(!((O=x.current)!=null&&O.value)){b(!0),p("danger","Please select a partner type");return}const ie={name:($=I.current)==null?void 0:$.value,email:u,mobile:v,password:L,password_confirmation:A,type_id:parseInt((G=x.current)==null?void 0:G.value),bank_name:(Z=_.current)==null?void 0:Z.value,account_number:(z=E.current)==null?void 0:z.value,ifsc_code:C.toUpperCase()};try{await fe("/api/partners/register",ie)?(p("success","Onboarding partner registered successfully"),r.reset(),j(!1),b(!1),d({}),w(!1),P(!1)):p("danger","Error occurred, please try again later.")}catch(t){const ne=((K=(J=t.response)==null?void 0:J.data)==null?void 0:K.message)||t.message;p("danger","Error occurred: "+ne),(W=(Q=t.response)==null?void 0:Q.data)!=null&&W.errors&&d(t.response.data.errors)}};return e.jsx("div",{className:"bg-body-tertiary min-vh-100 d-flex flex-row",children:e.jsx(de,{children:e.jsx(me,{className:"justify-content-center",children:e.jsx(pe,{md:9,lg:12,xl:12,children:e.jsxs(he,{className:"mx-6",children:[e.jsx(be,{children:e.jsx("strong",{children:"Register New Onboarding Partner"})}),e.jsx(xe,{className:"p-4",children:e.jsxs(ge,{noValidate:!0,validated:Y,onSubmit:oe,children:[e.jsxs(l,{className:"mb-4",children:[e.jsx(i,{children:e.jsx(n,{icon:ve})}),e.jsx(Ce,{onChange:re,"aria-label":"Select Partner Type",ref:x,invalid:ae,options:ee,feedbackInvalid:"Please select a partner type."})]}),e.jsxs(l,{className:"mb-3",children:[e.jsx(i,{children:e.jsx(n,{icon:je})}),e.jsx(m,{ref:I,type:"text",placeholder:"Partner Name",autoComplete:"name",required:!0,feedbackInvalid:"Please provide partner name."})]}),e.jsxs(l,{className:"mb-3",children:[e.jsx(i,{children:e.jsx(n,{icon:ye})}),e.jsx(m,{ref:R,placeholder:"Email Address",autoComplete:"email",type:"email",required:!0,invalid:!!c.email,onChange:a=>g("email",a.target.value),feedbackInvalid:c.email||"Please provide a valid email address."})]}),e.jsxs(l,{className:"mb-3",children:[e.jsx(i,{children:e.jsx(n,{icon:Pe})}),e.jsx(m,{ref:N,placeholder:"Mobile Number (10 digits)",autoComplete:"tel",type:"tel",maxLength:10,pattern:"[0-9]{10}",required:!0,invalid:!!c.mobile,onChange:a=>{const r=a.target.value.replace(/\D/g,"");a.target.value=r,g("mobile",r)},feedbackInvalid:c.mobile||"Please provide a valid 10-digit mobile number."})]}),e.jsxs(l,{className:"mb-3",children:[e.jsx(i,{children:e.jsx(n,{icon:X})}),e.jsx(m,{type:f?"text":"password",ref:S,placeholder:"Password (min 6 characters)",autoComplete:"new-password",minLength:6,required:!0,feedbackInvalid:"Please provide password (minimum 6 characters)."}),e.jsx(i,{onClick:se,style:{cursor:"pointer"},title:f?"Hide password":"Show password",children:f?"ðŸ”’":"ðŸ‘ï¸"})]}),e.jsxs(l,{className:"mb-4",children:[e.jsx(i,{children:e.jsx(n,{icon:X})}),e.jsx(m,{ref:k,type:h?"text":"password",placeholder:"Confirm Password",autoComplete:"new-password",minLength:6,required:!0,invalid:!!c.password_confirmation,feedbackInvalid:c.password_confirmation||"Please confirm your password."}),e.jsx(i,{onClick:te,style:{cursor:"pointer"},title:h?"Hide password":"Show password",children:h?"ðŸ”’":"ðŸ‘ï¸"})]}),e.jsx("hr",{className:"my-4"}),e.jsx("h5",{className:"mb-3",children:"Banking Details"}),e.jsxs(l,{className:"mb-3",children:[e.jsx(i,{children:e.jsx(n,{icon:we})}),e.jsx(m,{ref:_,type:"text",placeholder:"Bank Name",required:!0,feedbackInvalid:"Please provide bank name."})]}),e.jsxs(l,{className:"mb-3",children:[e.jsx(i,{children:e.jsx(n,{icon:Ie})}),e.jsx(m,{ref:E,type:"text",placeholder:"Account Number",maxLength:50,required:!0,onChange:a=>{const r=a.target.value.replace(/\D/g,"");a.target.value=r},feedbackInvalid:"Please provide account number."})]}),e.jsxs(l,{className:"mb-4",children:[e.jsx(i,{children:e.jsx(n,{icon:Re})}),e.jsx(m,{ref:T,type:"text",placeholder:"IFSC Code (e.g., SBIN0000123)",maxLength:11,required:!0,invalid:!!c.ifsc_code,onChange:a=>{const r=a.target.value.toUpperCase();a.target.value=r,g("ifsc_code",r)},feedbackInvalid:c.ifsc_code||"Please provide a valid IFSC code."})]}),e.jsx("div",{className:"d-grid col-sm-3",children:e.jsx(Ne,{color:"success",type:"submit",children:"Register Partner"})})]})})]})})})})})};export{ze as default};
