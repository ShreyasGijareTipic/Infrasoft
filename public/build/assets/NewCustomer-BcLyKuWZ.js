import{b as y,r as c,u as f,j as e}from"./index-BjGmA7Bo.js";import{g as j,a as g,p as N}from"./api-CIBCEetx.js";import{a as k,b as _}from"./index.esm-Dt7Qe3Av.js";import{C as F,a as L}from"./CCardBody-C0Yq84MQ.js";import{C as w}from"./CCardHeader-AnyY50zi.js";import{C as S}from"./CForm-vzVfQCWh.js";import{C as n}from"./CFormLabel-B_oLSbD9.js";import{C as u}from"./CFormInput-DF8ie22K.js";import{C as E}from"./CFormSelect-CFPHA-xf.js";import{C as I}from"./CFormTextarea-mg6q-B3W.js";import{C as h}from"./CButton-CC7WAWlS.js";import"./CFormControlWrapper-BkxhhPL_.js";const G=()=>{const{showToast:l}=y(),[s,m]=c.useState({name:"",mobile:"",discount:0,company_id:0,show:!0,address:""}),t=j(),[C,p]=c.useState([]),b=f();c.useEffect(()=>{try{g("/api/company").then(a=>{if(a!=null&&a.length){const o=a.map(r=>({label:r.company_name,value:r.company_id}));t.type===0?(p(o),o.length>0&&m({...s,company_id:o[0].value})):(p(o.filter(r=>r.value===t.company_id)),m(r=>({...r,company_id:t.company_id})))}})}catch(a){l("danger","Error occurred "+a)}},[t.type,t.company_id,s]);const i=a=>{const{name:o,value:r}=a.target;m({...s,[o]:r})},x=async a=>{a.preventDefault();const o=a.target;if(!o.checkValidity()){o.classList.add("was-validated");return}let r={...s};try{const d=await N("/api/customer",r);d!=null&&d.id&&(l("success","Customer created"),b("/usermanagement/all-users"),l("danger","Error occurred, please try again later."))}catch(d){l("danger","Error occurred "+d)}},v=()=>{m({name:"",mobile:"",discount:0,company_id:s.company_id,show:!0,address:""})};return e.jsx(k,{children:e.jsx(_,{xs:12,children:e.jsxs(F,{className:"mb-4",children:[e.jsx(w,{children:e.jsx("strong",{children:"Create New Customer"})}),e.jsx(L,{children:e.jsxs(S,{className:"needs-validation",noValidate:!0,onSubmit:x,children:[e.jsxs("div",{className:"mb-3",children:[e.jsx(n,{htmlFor:"pname",children:"Customer Name"}),e.jsx(u,{type:"text",id:"pname",placeholder:"Customer Name",name:"name",value:s.name,onChange:i,required:!0,feedbackInvalid:"Please provide name.",feedbackValid:"Looks good!"}),e.jsx("div",{className:"invalid-feedback",children:"Name is required"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(n,{htmlFor:"plmobile",children:"Mobile Number"}),e.jsx(u,{type:"text",id:"plmobile",placeholder:"Mobile Number",name:"mobile",value:s.mobile,onChange:i,pattern:"\\d{10}",required:!0,minLength:10,maxLength:10,feedbackInvalid:"Please provide valid mobile number.",feedbackValid:"Looks good!"}),e.jsx("div",{className:"invalid-feedback",children:"Mobile number is required"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(n,{htmlFor:"categoryId",children:"Company "}),e.jsx(E,{"aria-label":"Select Category",name:"company_id",value:s.company_id,options:C,onChange:i,required:!0}),e.jsx("div",{className:"invalid-feedback",children:"Please select a company"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(n,{htmlFor:"address",children:"Address"}),e.jsx(I,{id:"address",rows:2,name:"address",value:s.address,onChange:i})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(n,{htmlFor:"discount",children:"Special Discount (%) "}),e.jsx(u,{type:"number",id:"discount",placeholder:"5%",name:"discount",value:s.discount,onChange:i,feedbackInvalid:"Please provide valid number.",feedbackValid:"Looks good!"})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx(h,{color:"success",type:"submit",children:"Submit"}),"Â ",e.jsx(h,{color:"secondary",onClick:v,children:"Clear"})]})]})})]})})})};export{G as default};
