import{r as o,u as _,b as v,j as e}from"./index-DQ9cqY-w.js";import{a as w,d as M,b as N}from"./api-CIBCEetx.js";import{C as T,a as E}from"./CCardBody-nJ-qIk-T.js";import{C as S}from"./CCardHeader-Dxk59cNM.js";import{C as n}from"./CButton-Cv8rOKs_.js";import{C as D,a as R,b as m,c as i,d as k,e as s}from"./CTable-Bg7ZIw-y.js";import{a as A,b as B,c as F,d as H,e as O}from"./DefaultLayout-D1v7lmV6.js";import{C as u}from"./CFormInput-C2pMQ5Ja.js";import{C as I}from"./CFormSelect-D_PQmfUM.js";import"./index.esm-t1uhsutJ.js";import"./RawMaterial-BtjEDAbB.js";import"./cil-mobile-Cf1prUnf.js";import"./CFormControlWrapper-C03sehqW.js";import"./CFormLabel-C-r2uEyX.js";function Z(){const[p,x]=o.useState([]),[j,t]=o.useState(!1),[r,c]=o.useState({id:null,machine_name:"",reg_number:"",ownership_type:""}),C=_(),{showToast:l}=v(),d=async()=>{try{const a=await w("/api/machineries");x(a.data)}catch(a){console.error("Error fetching machineries:",a)}},g=async a=>{try{await M(`/api/machineries/${a}`),d(),l("success","Machine Delete Successfully")}catch(h){console.error("Error deleting machinery:",h),l("danger","Error deleting machinery")}},y=a=>{c({id:a.id,machine_name:a.machine_name,reg_number:a.reg_number,ownership_type:a.ownership_type}),t(!0)},b=async()=>{try{await N(`/api/machineries/${r.id}`,{machine_name:r.machine_name,reg_number:r.reg_number,ownership_type:r.ownership_type}),t(!1),l("success","Machine update successfully"),d()}catch(a){console.error("Error updating machinery:",a),l("danger","Failed to update machinery!")}},f=()=>{C("/addMachinery")};return o.useEffect(()=>{d()},[]),e.jsxs(e.Fragment,{children:[e.jsxs(T,{className:"mb-4",children:[e.jsxs(S,{className:"d-flex justify-content-between align-items-center",children:[e.jsx("strong",{children:"Machineries List"}),e.jsx(n,{color:"danger",onClick:f,children:"Add New Machinery"})]}),e.jsx(E,{children:e.jsx("div",{className:"table-responsive",children:e.jsxs(D,{hover:!0,striped:!0,children:[e.jsx(R,{children:e.jsxs(m,{children:[e.jsx(i,{children:"Sr. No."}),e.jsx(i,{children:"Machine Name"}),e.jsx(i,{children:"Reg. Number"}),e.jsx(i,{children:"Ownership"}),e.jsx(i,{children:"Action"})]})}),e.jsx(k,{children:p.length>0?p.map((a,h)=>e.jsxs(m,{children:[e.jsx(s,{children:h+1}),e.jsx(s,{children:a.machine_name}),e.jsx(s,{children:a.reg_number}),e.jsx(s,{children:a.ownership_type}),e.jsxs(s,{className:"d-flex flex-wrap gap-2",children:[e.jsx(n,{color:"info",size:"sm",className:"me-2 text-white",onClick:()=>y(a),children:"Edit"}),e.jsx(n,{color:"danger",size:"sm",onClick:()=>g(a.id),children:"Delete"})]})]},a.id)):e.jsx(m,{children:e.jsx(s,{colSpan:4,className:"text-center",children:"No machineries found"})})})]})})})]}),e.jsxs(A,{visible:j,onClose:()=>t(!1),children:[e.jsx(B,{closeButton:!0,children:e.jsx(F,{children:"Edit Machinery"})}),e.jsxs(H,{children:[e.jsx(u,{className:"mb-3",type:"text",label:"Machine Name",value:r.machine_name,onChange:a=>c({...r,machine_name:a.target.value})}),e.jsx(u,{type:"text",label:"Reg. Number",value:r.reg_number,onChange:a=>c({...r,reg_number:a.target.value})}),e.jsxs(I,{label:"Ownership Type",value:r.ownership_type||"",onChange:a=>c({...r,ownership_type:a.target.value}),children:[e.jsx("option",{value:"",children:"-- Select Ownership Type --"}),e.jsx("option",{value:"own",children:"Own"}),e.jsx("option",{value:"rent",children:"Rent"})]})]}),e.jsxs(O,{children:[e.jsx(n,{color:"secondary",onClick:()=>t(!1),children:"Cancel"}),e.jsx(n,{color:"primary",onClick:b,children:"Save Changes"})]})]})]})}export{Z as default};
