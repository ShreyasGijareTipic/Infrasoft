import{r as h,b as _,u as v,j as e}from"./index-DaQ8IcWH.js";import{a as N,p as S}from"./api-CIBCEetx.js";import{C as k,a as A}from"./CCardBody-BgdPVtOX.js";import{C as q}from"./CCardHeader-BnYSwQm7.js";import{C as E}from"./CForm-BkonVZOq.js";import{a as i,b as t}from"./index.esm-W-SaLQ2H.js";import{C as d}from"./CFormLabel-B6T8hfcB.js";import{C as c}from"./CFormInput-CplwN3WM.js";import{C as w}from"./CFormTextarea-17_s7S78.js";import{C as j}from"./CFormSelect-fqNFrf6e.js";import{C as P}from"./CFormCheck-C7HPNWXy.js";import{C as b}from"./CButton-RPa9QO-M.js";import"./CFormControlWrapper-CkuovpMX.js";const Z=()=>{const[r,l]=h.useState({name:"",mobile:"",address:"",bank_name:"",account_number:"",adhar_number:"",ifsc_code:"",pan_number:"",gst_no:"",payment:"",type:"",project_id:"",show:!0}),[y,p]=h.useState([]),{showToast:o}=_(),x=v();h.useEffect(()=>{N("/api/projects").then(n=>p(Array.isArray(n)?n:[])).catch(n=>{console.error(n),p([])})},[]);const m=n=>{const{name:a,value:s,type:u,checked:C}=n.target;l(f=>({...f,[a]:u==="checkbox"?C:s}))},g=async n=>{var s;if(n.preventDefault(),!r.name.trim()){o("danger","Name is required");return}if(!r.mobile||r.mobile.length!==10){o("danger","Mobile number must be 10 digits");return}if(!r.address.trim()){o("danger","Address is required");return}if(!r.type){o("danger","Role is required");return}if(r.type==="0"&&!r.project_id){o("danger","Project is required for Supervisor");return}if((r.type==="0"||r.type==="1")&&!r.payment){o("danger","Payment is required for Supervisor and Operator");return}if(r.type==="2"&&!r.gst_no.trim()){o("danger","GST Number is required for Vendor");return}if(r.type==="3"&&!r.gst_no.trim()){o("danger","GST Number is required for Vendor");return}if(r.bank_name&&!r.account_number){o("danger","Account Number is required when Bank Name is provided");return}if(r.account_number&&!r.bank_name){o("danger","Bank Name is required when Account Number is provided");return}if((r.bank_name||r.account_number)&&!r.ifsc_code){o("danger","IFSC Code is required when bank details are provided");return}const a={...r,project_id:r.type==="1"||r.type==="2"||r.type==="3"?"0":r.project_id,payment:r.type==="2"||r.type==="3"?"0":r.payment};try{await S("/api/operators",a),o("success","User created successfully!"),l({name:"",mobile:"",address:"",bank_name:"",account_number:"",adhar_number:"",ifsc_code:"",pan_number:"",gst_no:"",payment:"",type:"",project_id:"",show:!0}),x("/OpratorList")}catch(u){console.error("Error creating user:",((s=u.response)==null?void 0:s.data)||u.message),o("danger","Failed to create user")}};return e.jsxs(k,{className:"mb-4",children:[e.jsx(q,{children:e.jsx("strong",{children:"Create User (Supervisor / Operator / Vendor / Purches Vendor)"})}),e.jsx(A,{children:e.jsxs(E,{onSubmit:g,children:[e.jsxs(i,{className:"mb-3",children:[e.jsxs(t,{md:6,children:[e.jsxs(d,{children:["Name ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(c,{type:"text",name:"name",placeholder:"Enter Name",value:r.name,onChange:m,required:!0})]}),e.jsxs(t,{md:6,children:[e.jsxs(d,{children:["Mobile ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(c,{type:"text",name:"mobile",placeholder:"Enter Mobile Number (10 digits)",maxLength:10,value:r.mobile,onChange:n=>{const a=n.target.value;/^\d*$/.test(a)&&a.length<=10&&l(s=>({...s,mobile:a}))},required:!0})]})]}),e.jsx(i,{className:"mb-3",children:e.jsxs(t,{md:12,children:[e.jsxs(d,{children:["Address ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(w,{name:"address",placeholder:"Enter Address",value:r.address,onChange:m,required:!0})]})}),e.jsxs(i,{className:"mb-3",children:[e.jsxs(t,{md:4,children:[e.jsx(d,{children:"Bank Name"}),e.jsx(c,{name:"bank_name",placeholder:"Enter Bank Name",value:r.bank_name,onChange:m})]}),e.jsxs(t,{md:4,children:[e.jsx(d,{children:"Account Number"}),e.jsx(c,{name:"account_number",placeholder:"Enter Account Number",maxLength:18,value:r.account_number,onChange:n=>{const a=n.target.value;/^\d*$/.test(a)&&l(s=>({...s,account_number:a}))}})]}),e.jsxs(t,{md:4,children:[e.jsx(d,{children:"IFSC Code"}),e.jsx(c,{name:"ifsc_code",placeholder:"Enter IFSC Code (11 characters)",maxLength:11,value:r.ifsc_code,onChange:n=>{const a=n.target.value.toUpperCase();/^[A-Z0-9]*$/.test(a)&&l(s=>({...s,ifsc_code:a}))}})]})]}),e.jsxs(i,{className:"mb-3",children:[e.jsxs(t,{md:6,children:[e.jsx(d,{children:"Aadhar Number"}),e.jsx(c,{name:"adhar_number",placeholder:"Enter Aadhar Number (12 digits)",maxLength:12,value:r.adhar_number,onChange:n=>{const a=n.target.value;/^\d*$/.test(a)&&l(s=>({...s,adhar_number:a}))}})]}),e.jsxs(t,{md:6,children:[e.jsx(d,{children:"PAN Number"}),e.jsx(c,{name:"pan_number",placeholder:"Enter PAN Number (10 characters)",maxLength:10,value:r.pan_number,onChange:n=>{const a=n.target.value.toUpperCase();/^[A-Z0-9]*$/.test(a)&&l(s=>({...s,pan_number:a}))}})]})]}),e.jsxs(i,{className:"mb-3",children:[e.jsxs(t,{md:6,children:[e.jsxs(d,{children:["Select Role ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs(j,{name:"type",value:r.type,onChange:m,required:!0,children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"0",children:"Supervisor"}),e.jsx("option",{value:"1",children:"Operator"}),e.jsx("option",{value:"2",children:"Vendor"}),e.jsx("option",{value:"3",children:"Purches Vendor"})]})]}),e.jsx(t,{md:6,className:"d-flex align-items-center",children:e.jsx(P,{id:"show",label:"Show User",name:"show",checked:r.show,onChange:m})})]}),r.type==="0"&&e.jsxs(i,{className:"mb-3",children:[e.jsxs(t,{md:6,children:[e.jsxs(d,{children:["Payment ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(c,{type:"number",name:"payment",placeholder:"Enter Payment Amount",min:"0",value:r.payment,onKeyDown:n=>{["-","e","E"].includes(n.key)&&n.preventDefault()},onChange:m,required:!0})]}),e.jsxs(t,{md:6,children:[e.jsxs(d,{children:["Select Project ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsxs(j,{name:"project_id",value:r.project_id,onChange:m,children:[e.jsx("option",{value:"",children:"Select Project"}),y.map(n=>e.jsx("option",{value:String(n.id),children:n.project_name},n.id))]})]})]}),r.type==="1"&&e.jsx(i,{className:"mb-3",children:e.jsxs(t,{md:6,children:[e.jsxs(d,{children:["Payment ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(c,{type:"number",name:"payment",placeholder:"Enter Payment Amount",min:"0",value:r.payment,onKeyDown:n=>{["-","e","E"].includes(n.key)&&n.preventDefault()},onChange:m,required:!0})]})}),(r.type==="2"||r.type==="3")&&e.jsx(i,{className:"mb-3",children:e.jsxs(t,{md:6,children:[e.jsxs(d,{children:["GST Number ",e.jsx("span",{style:{color:"red"},children:"*"})]}),e.jsx(c,{name:"gst_no",placeholder:"Enter GST Number (15 characters)",maxLength:15,value:r.gst_no,onChange:n=>{const a=n.target.value.toUpperCase();/^[0-9A-Z]*$/.test(a)&&l(s=>({...s,gst_no:a}))},required:!0})]})}),e.jsxs(i,{className:"mt-3",children:[e.jsx(t,{xs:"auto",children:e.jsx(b,{type:"submit",color:"primary",children:"Submit"})}),e.jsx(t,{xs:"auto",children:e.jsx(b,{type:"button",color:"secondary",onClick:()=>x("/OpratorList"),children:"Close"})})]})]})})]})};export{Z as default};
